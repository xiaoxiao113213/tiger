import{r as e,i as t,bY as n,ar as r,j as a,aq as i,bZ as o,b_ as l,bA as d,ao as s,b$ as u,bE as c,c0 as f,P as p,c1 as g,c2 as v,c3 as m,F as x,c4 as h,c5 as y,c6 as I,c7 as b,c8 as w,B as S,c9 as j,ca as C,cb as R,c as T,N as D,O as N,q as E}from"./index-1fe6dff8.js";import{M as K}from"./MysqlTypeDic-39b9eb62.js";import{TableFormTypeEnum as k,MyInput as F,FlagNotNullCheckbox as P}from"./TableFieldForm-22d821be.js";import{getDefaultFieldListApi as V,tableSaveDefaultFieldListApi as O}from"./api-a8f9de29.js";import{K as M,b as A,c as B,d as L,e as U,f as q,g as H,i as J,C as z,h as Y,u as _,a as X,M as W,P as G,D as Z,j as $}from"./core.esm-76f81c27.js";import"./dicApi-b68549fb.js";const Q=e=>{let{transform:t}=e;return{...t,x:0}};function ee(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function te(e,t){return e.reduce(((e,n,r)=>{const a=t.get(n);return a&&(e[r]=a),e}),Array(e.length))}function ne(e){return null!==e&&e>=0}const re=e=>{let{rects:t,activeIndex:n,overIndex:r,index:a}=e;const i=ee(t,r,n),o=t[a],l=i[a];return l&&o?{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}:null},ae={scaleX:1,scaleY:1},ie=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:a,rects:i,overIndex:o}=e;const l=null!=(t=i[n])?t:r;if(!l)return null;if(a===n){const e=i[o];return e?{x:0,y:n<o?e.top+e.height-(l.top+l.height):e.top-l.top,...ae}:null}const d=function(e,t,n){const r=e[t],a=e[t-1],i=e[t+1];if(!r)return 0;if(n<t)return a?r.top-(a.top+a.height):i?i.top-(r.top+r.height):0;return i?i.top-(r.top+r.height):a?r.top-(a.top+a.height):0}(i,a,n);return a>n&&a<=o?{x:0,y:-l.height-d,...ae}:a<n&&a>=o?{x:0,y:l.height+d,...ae}:{x:0,y:0,...ae}};const oe="Sortable",le=t.createContext({activeIndex:-1,containerId:oe,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:re,disabled:{draggable:!1,droppable:!1}});function de(n){let{children:r,id:a,items:i,strategy:o=re,disabled:l=!1}=n;const{active:d,dragOverlay:s,droppableRects:u,over:c,measureDroppableContainers:f}=A(),p=B(oe,a),g=Boolean(null!==s.rect),v=e.useMemo((()=>i.map((e=>"object"==typeof e&&"id"in e?e.id:e))),[i]),m=null!=d,x=d?v.indexOf(d.id):-1,h=c?v.indexOf(c.id):-1,y=e.useRef(v),I=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(v,y.current),b=-1!==h&&-1===x||I,w=function(e){return"boolean"==typeof e?{draggable:e,droppable:e}:e}(l);L((()=>{I&&m&&f(v)}),[I,v,m,f]),e.useEffect((()=>{y.current=v}),[v]);const S=e.useMemo((()=>({activeIndex:x,containerId:p,disabled:w,disableTransforms:b,items:v,overIndex:h,useDragOverlay:g,sortedRects:te(v,u),strategy:o})),[x,p,w.draggable,w.droppable,b,v,h,u,g,o]);return t.createElement(le.Provider,{value:S},r)}const se=e=>{let{id:t,items:n,activeIndex:r,overIndex:a}=e;return ee(n,r,a).indexOf(t)},ue=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:a,items:i,newIndex:o,previousItems:l,previousContainerId:d,transition:s}=e;return!(!s||!r)&&((l===i||a!==o)&&(!!n||o!==a&&t===d))},ce={duration:200,easing:"ease"},fe="transform",pe=z.Transition.toString({property:fe,duration:0,easing:"linear"}),ge={roleDescription:"sortable"};function ve(t){let{animateLayoutChanges:n=ue,attributes:r,disabled:a,data:i,getNewIndex:o=se,id:l,strategy:d,resizeObserverConfig:s,transition:u=ce}=t;const{items:c,containerId:f,activeIndex:p,disabled:g,disableTransforms:v,sortedRects:m,overIndex:x,useDragOverlay:h,strategy:y}=e.useContext(le),I=function(e,t){var n,r;if("boolean"==typeof e)return{draggable:e,droppable:!1};return{draggable:null!=(n=null==e?void 0:e.draggable)?n:t.draggable,droppable:null!=(r=null==e?void 0:e.droppable)?r:t.droppable}}(a,g),b=c.indexOf(l),w=e.useMemo((()=>({sortable:{containerId:f,index:b,items:c},...i})),[f,i,b,c]),S=e.useMemo((()=>c.slice(c.indexOf(l))),[c,l]),{rect:j,node:C,isOver:R,setNodeRef:T}=U({id:l,data:w,disabled:I.droppable,resizeObserverConfig:{updateMeasurementsFor:S,...s}}),{active:D,activatorEvent:N,activeNodeRect:E,attributes:K,setNodeRef:k,listeners:F,isDragging:P,over:V,setActivatorNodeRef:O,transform:M}=q({id:l,data:w,attributes:{...ge,...r},disabled:I.draggable}),A=H(T,k),B=Boolean(D),_=B&&!v&&ne(p)&&ne(x),X=!h&&P,W=X&&_?M:null,G=_?null!=W?W:(null!=d?d:y)({rects:m,activeNodeRect:E,activeIndex:p,overIndex:x,index:b}):null,Z=ne(p)&&ne(x)?o({id:l,items:c,activeIndex:p,overIndex:x}):b,$=null==D?void 0:D.id,Q=e.useRef({activeId:$,items:c,newIndex:Z,containerId:f}),ee=c!==Q.current.items,te=n({active:D,containerId:f,isDragging:P,isSorting:B,id:l,index:b,items:c,newIndex:Q.current.newIndex,previousItems:Q.current.items,previousContainerId:Q.current.containerId,transition:u,wasDragging:null!=Q.current.activeId}),re=function(t){let{disabled:n,index:r,node:a,rect:i}=t;const[o,l]=e.useState(null),d=e.useRef(r);return L((()=>{if(!n&&r!==d.current&&a.current){const e=i.current;if(e){const t=Y(a.current,{ignoreTransform:!0}),n={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(n.x||n.y)&&l(n)}}r!==d.current&&(d.current=r)}),[n,r,a,i]),e.useEffect((()=>{o&&l(null)}),[o]),o}({disabled:!te,index:b,node:C,rect:j});return e.useEffect((()=>{B&&Q.current.newIndex!==Z&&(Q.current.newIndex=Z),f!==Q.current.containerId&&(Q.current.containerId=f),c!==Q.current.items&&(Q.current.items=c)}),[B,Z,f,c]),e.useEffect((()=>{if($===Q.current.activeId)return;if($&&!Q.current.activeId)return void(Q.current.activeId=$);const e=setTimeout((()=>{Q.current.activeId=$}),50);return()=>clearTimeout(e)}),[$]),{active:D,activeIndex:p,attributes:K,data:w,rect:j,index:b,newIndex:Z,items:c,isOver:R,isSorting:B,isDragging:P,listeners:F,node:C,overIndex:x,over:V,setNodeRef:A,setActivatorNodeRef:O,setDroppableNodeRef:T,setDraggableNodeRef:k,transform:null!=re?re:G,transition:function(){if(re||ee&&Q.current.newIndex===b)return pe;if(X&&!J(N)||!u)return;if(B||te)return z.Transition.toString({...u,property:fe});return}()}}M.Down,M.Right,M.Up,M.Left;var me=["DragHandle","dragSortKey"],xe=["dragSortKey"],he=e.createContext({handle:null}),ye=function(e){var n=ve({id:e.id}),o=n.attributes,l=n.listeners,d=n.setNodeRef,s=n.transform,u=n.transition,c=r({transform:z.Transform.toString(s),transition:u},null==e?void 0:e.style),f=e.DragHandle,p=e.dragSortKey,g=i(e,me);if(p){var v=[];return t.Children.forEach(g.children,(function(e,t){var n,i;e.key!==p?v.push(e):v.push(a.jsx(he.Provider,{value:{handle:a.jsx(f,r(r({rowData:null==e||null===(n=e.props)||void 0===n?void 0:n.record,index:null==e||null===(i=e.props)||void 0===i?void 0:i.index},l),o))},children:e},e.key||t))})),a.jsx("tr",r(r({},g),{},{ref:d,style:c,children:v}))}return a.jsx("tr",r(r(r({},g),{},{ref:d,style:c},o),l))},Ie=t.memo((function(t){t.dragSortKey;var n=i(t,xe),o=e.useContext(he).handle;return o?a.jsx("td",r(r({},n),{},{children:a.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[o," ",n.children]})})):a.jsx("td",r({},n))})),be=function(e){return a.jsx("tbody",r({},e))};function we(t){var i,l=t.dataSource,d=void 0===l?[]:l,s=t.onDragSortEnd,u=t.DragHandle,c=t.dragSortKey,f=_(X(G),X(W)),p=e.useCallback((function(e){var t,n=e.active,r=e.over;if(null!=r&&null!==(t=r.id)&&void 0!==t&&t.toString()&&n.id!==(null==r?void 0:r.id)){var a=ee(d||[],parseInt(n.id),parseInt(r.id));null==s||s(parseInt(n.id),parseInt(r.id),a||[])}}),[d,s]),g=n((function(e){return a.jsx(de,{items:d.map((function(e,t){return null==t?void 0:t.toString()})),strategy:ie,children:a.jsx(be,r({},e))})})),v=n((function(e){var n,i=Object.assign({},(o(e),e)),l=null===(n=d.findIndex((function(e){var n;return e[null!==(n=t.rowKey)&&void 0!==n?n:"index"]===i["data-row-key"]})))||void 0===n?void 0:n.toString();return a.jsx(ye,r({id:l,dragSortKey:c,DragHandle:u},i),l)})),m=t.components||{};c&&(m.body=r({wrapper:g,row:v,cell:Ie},(null===(i=t.components)||void 0===i?void 0:i.body)||{}));return{DndContext:e.useMemo((function(){return function(e){return a.jsx(Z,{modifiers:[Q],sensors:f,collisionDetection:$,onDragEnd:p,children:e.children})}}),[p,f]),components:m}}var Se=function(e){return d({},e.componentCls,{"&-icon":{marginInlineEnd:8,color:e.colorTextSecondary,cursor:"grab !important",padding:4,fontSize:12,borderRadius:e.borderRadius,"&:hover":{color:e.colorText,backgroundColor:e.colorInfoBg}}})};var je=["rowKey","dragSortKey","dragSortHandlerRender","onDragSortEnd","onDataSourceChange","defaultData","dataSource","onLoad"],Ce=["rowData","index","className"];function Re(t){var n,o,d=t.rowKey,m=t.dragSortKey,x=t.dragSortHandlerRender,h=t.onDragSortEnd,y=t.onDataSourceChange,I=t.defaultData,b=t.dataSource,w=t.onLoad,S=i(t,je),j=e.useContext(s.ConfigContext).getPrefixCls,C=u((function(){return I||[]}),{value:b,onChange:y}),R=c(C,2),T=R[0],D=R[1],N=(o=j("pro-table-drag"),l("DragSortTable",(function(e){var t=r(r({},e),{},{componentCls:".".concat(o)});return[Se(t)]}))),E=N.wrapSSR,K=N.hashId,k=e.useMemo((function(){return function(e){e.rowData,e.index;var t=e.className,n=i(e,Ce),o=a.jsx(f,r(r({},n),{},{className:"".concat(j("pro-table-drag-icon")," ").concat(t||""," ").concat(K||"").trim()})),l=x?x(null==e?void 0:e.rowData,null==e?void 0:e.index):o;return a.jsx("div",r(r({},n),{},{children:l}))}}),[j]),F=we({dataSource:null==T?void 0:T.slice(),dragSortKey:m,onDragSortEnd:h,components:t.components,rowKey:d,DragHandle:k}),P=F.components,V=F.DndContext,O=function(){var e=g(v().mark((function e(t){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(t),e.abrupt("return",null==w?void 0:w(t));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return E(a.jsx(p,r(r({},S),{},{columns:null===(n=S.columns)||void 0===n?void 0:n.map((function(e){return e.dataIndex!=m&&e.key!==m||e.render||(e.render=function(){return null}),e})),onLoad:O,rowKey:d,tableViewRender:function(e,t){return a.jsx(V,{children:t})},dataSource:T,components:P,onDataSourceChange:y})))}var Te=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],De=["record","position","creatorButtonText","newRecordType","parentKey","style"],Ne=t.createContext(void 0);function Ee(n){var a,i=n.children,o=n.record,l=n.position,d=n.newRecordType,s=n.parentKey,u=e.useContext(Ne);return t.cloneElement(i,r(r({},i.props),{},{onClick:(a=g(v().mark((function e(t){var n,r,a;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=(r=i.props).onClick)||void 0===n?void 0:n.call(r,t);case 2:if(!1!==e.sent){e.next=5;break}return e.abrupt("return");case 5:null==u||null===(a=u.current)||void 0===a||a.addEditRecord(o,{position:l,newRecordType:d,parentKey:s});case 6:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})}))}function Ke(o){var l,s,f=y(),g=o.onTableChange,v=o.maxLength;o.formItemProps;var m=o.recordCreatorProps,x=o.rowKey;o.controlled;var T=o.defaultValue;o.onChange;var D=o.editableFormRef,N=i(o,Te),E=e.useRef(void 0),K=e.useRef(),k=e.useRef();e.useImperativeHandle(N.actionRef,(function(){return K.current}),[K.current]);var F=u((function(){return o.value||T||[]}),{value:o.value,onChange:o.onChange}),P=c(F,2),V=P[0],O=P[1],M=t.useMemo((function(){return"function"==typeof x?x:function(e,t){return e[x]||t}}),[x]),A=n((function(e){if("number"==typeof e&&!o.name){if(e>=V.length)return e;var t=V&&V[e];return null==M?void 0:M(t,e)}if(("string"==typeof e||e>=V.length)&&o.name){var n=V.findIndex((function(t,n){var r;return(null==M||null===(r=M(t,n))||void 0===r?void 0:r.toString())===(null==e?void 0:e.toString())}));if(-1!==n)return n}return e}));e.useImperativeHandle(D,(function(){var e=function(e){var t,n;if(null==e)throw new Error("rowIndex is required");var r=A(e),a=[o.name,null!==(t=null==r?void 0:r.toString())&&void 0!==t?t:""].flat(1).filter(Boolean);return null===(n=k.current)||void 0===n?void 0:n.getFieldValue(a)};return r(r({},k.current),{},{getRowData:e,getRowsData:function(){var e,t=[o.name].flat(1).filter(Boolean);if(Array.isArray(t)&&0===t.length){var n,r=null===(n=k.current)||void 0===n?void 0:n.getFieldsValue();return Array.isArray(r)?r:Object.keys(r).map((function(e){return r[e]}))}return null===(e=k.current)||void 0===e?void 0:e.getFieldValue(t)},setRowData:function(t,n){var a,i;if(null==t)throw new Error("rowIndex is required");var l=A(t),d=[o.name,null!==(a=null==l?void 0:l.toString())&&void 0!==a?a:""].flat(1).filter(Boolean),s=Object.assign({},r(r({},e(t)),n||{})),u=I({},d,s);return null===(i=k.current)||void 0===i||i.setFieldsValue(u),!0}})}),[A,o.name,k.current]),e.useEffect((function(){o.controlled&&(V||[]).forEach((function(e,t){var n;null===(n=k.current)||void 0===n||n.setFieldsValue(d({},"".concat(M(e,t)),e))}),{})}),[b(V),o.controlled]),e.useEffect((function(){var e;o.name&&(k.current=null==o||null===(e=o.editable)||void 0===e?void 0:e.form)}),[null===(l=o.editable)||void 0===l?void 0:l.form,o.name]);var B=m||{},L=B.record,U=B.position,q=B.creatorButtonText,H=B.newRecordType,J=B.parentKey,z=B.style,Y=i(B,De),_="top"===U,X=e.useMemo((function(){return!("number"==typeof v&&v<=(null==V?void 0:V.length))&&(!1!==m&&a.jsx(Ee,{record:w(L,null==V?void 0:V.length,V)||{},position:U,parentKey:w(J,null==V?void 0:V.length,V),newRecordType:H,children:a.jsx(S,r(r({type:"dashed",style:r({display:"block",margin:"10px 0",width:"100%"},z),icon:a.jsx(j,{})},Y),{},{children:q||f.getMessage("editableTable.action.add","添加一行数据")}))}))}),[m,v,null==V?void 0:V.length]),W=e.useMemo((function(){return X?_?{components:{header:{wrapper:function(e){var t,n=e.className,r=e.children;return a.jsxs("thead",{className:n,children:[r,a.jsxs("tr",{style:{position:"relative"},children:[a.jsx("td",{colSpan:0,style:{visibility:"hidden"},children:X}),a.jsx("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:null===(t=N.columns)||void 0===t?void 0:t.length,children:X})]})]})}}}}:{tableViewRender:function(e,t){var n,r;return a.jsxs(a.Fragment,{children:[null!==(n=null===(r=o.tableViewRender)||void 0===r?void 0:r.call(o,e,t))&&void 0!==n?n:t,X]})}}:{}}),[_,X]),G=r({},o.editable),Z=n((function(e,t){var n,r,a,i;(null===(n=o.editable)||void 0===n||null===(r=n.onValuesChange)||void 0===r||r.call(n,e,t),null===(a=o.onValuesChange)||void 0===a||a.call(o,t,e),o.controlled)&&(null==o||null===(i=o.onChange)||void 0===i||i.call(o,t))}));return(null!=o&&o.onValuesChange||null!==(s=o.editable)&&void 0!==s&&s.onValuesChange||o.controlled&&null!=o&&o.onChange)&&(G.onValuesChange=Z),a.jsxs(a.Fragment,{children:[a.jsx(Ne.Provider,{value:K,children:a.jsx(p,r(r(r({search:!1,options:!1,pagination:!1,rowKey:x,revalidateOnFocus:!1},N),W),{},{tableLayout:"fixed",actionRef:K,onChange:g,editable:r(r({},G),{},{formProps:r({formRef:k},G.formProps)}),dataSource:V,onDataSourceChange:function(e){if(O(e),o.name&&"top"===U){var t,n=I({},[o.name].flat(1).filter(Boolean),e);null===(t=k.current)||void 0===t||t.setFieldsValue(n)}}}))}),o.name?a.jsx(C,{name:[o.name],children:function(e){var t,n;if(!E.current)return E.current=V,null;var r=h(e,[o.name].flat(1)),a=null==r?void 0:r.find((function(e,t){var n;return!R(e,null===(n=E.current)||void 0===n?void 0:n[t])}));return E.current=V,a?(null==o||null===(t=o.editable)||void 0===t||null===(n=t.onValuesChange)||void 0===n||n.call(t,a,r),null):null}}):null]})}function ke(e){var t=m.useFormInstance();return e.name?a.jsx(x.Item,r(r({style:{maxWidth:"100%"}},null==e?void 0:e.formItemProps),{},{name:e.name,shouldUpdate:function(t,n){var r=[e.name].flat(1);try{return JSON.stringify(h(t,r))!==JSON.stringify(h(n,r))}catch(a){return!0}},children:a.jsx(Ke,r(r({},e),{},{editable:r(r({},e.editable),{},{form:t})}))})):a.jsx(Ke,r({},e))}ke.RecordCreator=Ee;const Fe=t=>{const[n,r]=e.useState([]),[i,o]=e.useState([]),[l,d]=e.useState([]),[s,u]=e.useState(k.编辑),c=e.useRef(),{MysqlTypeList:f,MysqlTypeValueEnum:p}=K(),[g,v]=e.useState({emptyString:{text:"empty string"},CURRENT_TIMESTAMP:{text:"now"},"CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP":{text:"now and update now"}}),m=e=>{o(e)},x=e=>{o((t=>t.filter((t=>t.id!=e))))};e.useEffect((()=>(V({databaseBoardId:t.databaseBoardId}).then((e=>{T(e)||(e.data.forEach(((e,t)=>{e.id=D(9)})),o(e.data))})),()=>{})),[]),e.useEffect((()=>{let e=i.map((e=>e.id));return r(e),()=>{}}),[i]),e.useEffect((()=>{const e=async e=>{if(/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)?e.metaKey:e.ctrlKey)switch(e.key){case"c":{if(!l)return;let e=i.filter((e=>l.includes(e.id)));if(e?.length<=0)break;navigator.clipboard.writeText(JSON.stringify({fields:e})).then((()=>{})).catch((e=>{}));break}case"v":navigator.clipboard.readText().then((async e=>{if(!e)return;let t=JSON.parse(e);if(t.fields){for(let e of t.fields){i.find((t=>t.code===e.code))||i.push(e)}o(JSON.parse(JSON.stringify(i))),o((e=>(u(k.排序),setTimeout((()=>{u(k.编辑)}),250),e)))}})).catch((e=>{}));break;case"s":e.preventDefault()}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[l,i]);let h=a.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[a.jsx("span",{style:{flexGrow:1},children:"名"}),a.jsxs(S,{type:"link",onClick:()=>{s===k.编辑?u(k.排序):u(k.编辑)},children:[s===k.编辑&&"排序模式",s===k.排序&&"编辑模式"]})]});const y=[{title:h,dataIndex:"code",width:180,formItemProps:{rules:[{required:!0,whitespace:!0,message:"此项是必填项"}]},renderFormItem:()=>a.jsx(F,{})},{title:"类型",key:"type",dataIndex:"type",valueType:"select",fieldProps:{showSearch:!0},width:"200px",valueEnum:p},{title:"长度",valueType:"digit",width:"100px",dataIndex:"length"},{title:"小数点",valueType:"digit",width:"100px",dataIndex:"decimal"},{title:"不空",dataIndex:"flagNotNull",width:"50px",renderFormItem:e=>a.jsx(P,{ifShow:!0}),render:(e,t)=>a.jsx(E,{checked:1==t.flagNotNull})},{title:"主键",dataIndex:"flagKey",width:"50px",renderFormItem:e=>a.jsx(P,{ifShow:!0}),render:(e,t)=>a.jsx(E,{checked:1==t.flagKey})},{title:"默认值",dataIndex:"defaultValue",valueType:"select",fieldProps:{mode:"tags",maxCount:1},valueEnum:g},{title:"描述",valueType:"text",dataIndex:"desc",renderFormItem:()=>a.jsx(F,{})},{title:"自动递增",dataIndex:"flagAutoIncrement",width:"50px",renderFormItem:e=>e?.entity?.type?a.jsx(P,{ifShow:"bigint"==e.entity.type||"int"==e.entity.type||"integer"==e.entity.type}):"",render:(e,t)=>a.jsx(E,{checked:1==t.flagAutoIncrement})},{title:"无符号",dataIndex:"flagUnsigned",width:"50px",renderFormItem:e=>e?.entity?.type?a.jsx(P,{ifShow:"bigint"==e.entity.type||"int"==e.entity.type||"integer"==e.entity.type}):"",render:(e,t)=>a.jsx(E,{checked:1==t.flagUnsigned})},{title:"操作",valueType:"option",width:50,render:(e,t,n,r)=>[a.jsx("a",{onClick:()=>{x(t.id)},children:"删除"},"delete")]}],I=[{title:"排序",dataIndex:"sort",width:60,className:"drag-visible"},{title:h,dataIndex:"code",width:180,formItemProps:{rules:[{required:!0,whitespace:!0,message:"此项是必填项"}]},renderFormItem:()=>a.jsx(F,{})},{title:"类型",key:"type",dataIndex:"type",valueType:"select",fieldProps:{showSearch:!0},width:"200px",valueEnum:p},{title:"长度",valueType:"digit",width:"100px",dataIndex:"length"},{title:"小数点",valueType:"digit",width:"100px",dataIndex:"decimal"},{title:"不空",dataIndex:"flagNotNull",width:"50px",renderFormItem:e=>a.jsx(P,{ifShow:!0}),render:(e,t)=>a.jsx(E,{checked:1==t.flagNotNull})},{title:"主键",dataIndex:"flagKey",width:"50px",renderFormItem:e=>a.jsx(P,{ifShow:!0}),render:(e,t)=>a.jsx(E,{checked:1==t.flagKey})},{title:"默认值",dataIndex:"defaultValue",valueType:"select",fieldProps:{mode:"tags",maxCount:1},valueEnum:g},{title:"描述",valueType:"text",dataIndex:"desc",renderFormItem:()=>a.jsx(F,{})},{title:"自动递增",dataIndex:"flagAutoIncrement",width:"50px",renderFormItem:e=>e?.entity?.type?a.jsx(P,{ifShow:"bigint"==e.entity.type||"int"==e.entity.type||"integer"==e.entity.type}):"",render:(e,t)=>a.jsx(E,{checked:1==t.flagAutoIncrement})},{title:"无符号",dataIndex:"flagUnsigned",width:"50px",renderFormItem:e=>e?.entity?.type?a.jsx(P,{ifShow:"bigint"==e.entity.type||"int"==e.entity.type||"integer"==e.entity.type}):"",render:(e,t)=>a.jsx(E,{checked:1==t.flagUnsigned})},{title:"操作",valueType:"option",width:50,render:(e,t,n,r)=>[a.jsx("a",{onClick:()=>{x(t.id)},children:"删除"},"delete")]}];return a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{marginBottom:10},children:a.jsx(S,{type:"primary",onClick:async()=>{let e=await O({databaseBoardId:t.databaseBoardId,fieldList:i});T(e)||t.setDefaultFieldModalFn(N.close)},children:"保存"})}),s===k.编辑&&a.jsx(ke,{size:"small",rowKey:"id",headerTitle:"",editableFormRef:c,scroll:{x:960},recordCreatorProps:{newRecordType:"dataSource",record:()=>({code:"",id:D(9),flagNotNull:0,flagKey:0})},controlled:!0,loading:!1,columns:y,value:i,editable:{type:"multiple",editableKeys:n,actionRender:(e,t,n)=>[a.jsx("a",{onClick:()=>{x(e.id)},children:"删除"},"delete")],onValuesChange:(e,t)=>{if(e){let n=t.find((t=>t.id==e.id));1===e?.flagKey&&(n.flagNotNull=1),n.defaultValue&&Array.isArray(n.defaultValue)&&(n.defaultValue.length>=1?n.defaultValue=n.defaultValue[0]:n.defaultValue=null)}m(t)},onChange:r},tableAlertRender:!1,rowSelection:{selectedRowKeys:l,onChange:d,columnWidth:60}}),s===k.排序&&a.jsx(Re,{size:"small",headerTitle:"",columns:I,rowKey:"id",pagination:!1,search:!1,options:!1,dataSource:i,dragSortKey:"sort",onDragSortEnd:(e,t,n)=>{m(n)}})]})};export{Fe as default};
