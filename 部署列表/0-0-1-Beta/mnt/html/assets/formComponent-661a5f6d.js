import{r as e,N as i,F as r,j as t,Q as s,V as d,W as o,h as n,B as l,m as a,ab as p,I as m,f as c}from"./index-03adb9ee.js";import{d as u}from"./Title-06decefc.js";import{FormFieldTypeEnum as f}from"./Bo-c1a8a5bb.js";import x from"./index-dc46b847.js";import g from"./customerFieldNew-4c66ff92.js";import{C as j}from"./index-3585a1a3.js";import{D as h}from"./DeleteOutlined-2f949a39.js";import"./Input-51214805.js";import"./TextArea-24b2fc1a.js";import"./textSubmit-bd6c5b40.js";import"./textAreaSubmit-3b52d66b.js";import"./SelectSubmit-4c180fb2.js";import"./MutSelectSubmit-064a257d.js";import"./FileSubmit-a73b537e.js";import"./PlusOutlined-b4032aa8.js";import"./DateSubmit-95284b79.js";import"./NumberSubmit-77884c9b.js";import"./customerText-d905b3cb.js";import"./customerTextArea-b54e4aae.js";import"./customerSelect-ae4ebf75.js";import"./MinusCircleOutlined-ad177d4a.js";import"./MinusCircleOutlined-47af1d51.js";import"./customerMutSelect-fbe47964.js";import"./CustomerFile-75bdcaec.js";import"./CustomerDate-852678e3.js";import"./customerNumber-dffe68a9.js";const b=[{id:"input-1",name:"文本框",type:f.text,value:""},{id:"select-1",name:"数字框",type:f.number,value:""},{id:"textarea-1",name:"文本域",type:f.textArea,value:""},{id:"select-2",name:"下拉单选",type:f.select,value:""},{id:"select-3",name:"下拉多选",type:f.mutSelect,value:[]},{id:"file-1",name:"文件",type:f.file,value:{fileList:[]}},{id:"date-1",name:"时间",type:f.date,value:void 0}],y=e.forwardRef(((f,y)=>{const{excludedControls:v}=f,F=f.showScope??!1,S=f.isEditScope??!0,[I]=e.useState(b.filter((e=>!(v??[]).includes(e.type)))),[w,C]=e.useState([]);e.useEffect((()=>{f.initFormDesign&&(f.initFormDesign.forEach((e=>{e.formFieldId=i(10)})),C(f.initFormDesign))}),[]);const[D]=r.useForm(),[A]=r.useForm(),[P,R]=e.useState();return e.useImperativeHandle(y,(()=>({getFieldList:()=>w}))),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"20px",backgroundColor:"#f0f0f0",minHeight:"500px"},children:[t.jsx(s,{onDragEnd:e=>{const{source:r,destination:t}=e;if(t){if("controls"===r.droppableId&&"formDesign"===t.droppableId){const e=I[r.index];let s;F&&(s=0);const d={keyName:c(),optional:[],desc:"",notNull:1,scope:s,dateType:0,unit:void 0,...e,id:i(10),formFieldId:i(10)},o=[...w];o.splice(t.index,0,d),C(o)}if("formDesign"===r.droppableId&&"formDesign"===t.droppableId){const e=Array.from(w),[i]=e.splice(r.index,1);e.splice(t.index,0,i),C(e)}}},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flex:1},children:[t.jsx(d,{droppableId:"controls",isDropDisabled:!0,children:e=>t.jsxs("div",{...e.droppableProps,ref:e.innerRef,style:{width:200,padding:10,backgroundColor:"#f8f8f8",borderRadius:"4px"},children:[t.jsx(u,{level:4,style:{textAlign:"center",marginBottom:"20px"},children:"控件选项"}),I.map(((e,i)=>t.jsx(o,{draggableId:e.id,index:i,children:i=>t.jsx("div",{ref:i.innerRef,...i.draggableProps,...i.dragHandleProps,style:{padding:10,margin:"0 0 10px 0",background:"#fff",border:"1px solid #ccc",borderRadius:"4px",...i.draggableProps.style},children:e.name})},e.id))),e.placeholder]})}),t.jsx(j,{style:{width:"100%",margin:"0 20px",background:"#f8f8f8"},children:t.jsx(d,{droppableId:"formDesign",children:e=>t.jsxs("div",{...e.droppableProps,ref:e.innerRef,style:{width:"100%",paddingLeft:10,paddingRight:10,background:"rgba(255, 255, 255, 0.8)",borderRadius:"4px"},children:[t.jsxs(r,{form:D,validateTrigger:"false",style:{width:"100%",height:"100%",marginBottom:"20px"},onValuesChange:(e,i)=>{w.forEach((i=>{e.hasOwnProperty(i.id)&&(i.value=e[i.id])})),C(w)},children:[t.jsx(u,{level:4,style:{textAlign:"center"},children:"表单"}),w.length>0?w.map(((e,i)=>t.jsx(o,{draggableId:e.formFieldId,index:i,children:i=>t.jsx(n,{trigger:"contextMenu",placement:"rightTop",content:t.jsx(l,{icon:t.jsx(h,{}),onClick:()=>{const i=w.find((i=>i.id===e.id));if(i&&i.scope&&!S)return void a.error("插件全局参数不允许删除");const r=w.filter((i=>i.id!==e.id));C(r)}}),children:t.jsx("div",{onClick:()=>{const i=w.find((i=>i.id===e.id));i&&i.scope&&!S||(R(e),A?.setFieldsValue(e))},ref:i.innerRef,...i.draggableProps,...i.dragHandleProps,style:{borderLeft:P?.id===e.id?"5px solid #8AA6EA":"none",borderRight:P?.id===e.id?"5px solid #8AA6EA":"none",borderTop:"none",borderBottom:"none",borderRadius:5,...i.draggableProps.style},children:t.jsx(x,{initFieldBo:e},e.id)})})},e.formFieldId))):t.jsx("p",{children:"拖拽控件到这里"})]},"addFrom"),t.jsx(p,{}),e.placeholder]})})})]})}),t.jsxs("div",{style:{width:300,padding:10,background:"#f8f8f8",border:"1px solid #ccc",borderRadius:"4px",overflowY:"auto"},children:[t.jsx("h3",{children:"属性展示"}),P&&t.jsxs(r,{form:A,validateTrigger:"false",style:{width:"100%",height:"100%"},onValuesChange:(e,r)=>{const t=[...w],s=r.id,d=t.find((e=>e.id===s));if(d){for(let i in d)e.hasOwnProperty(i)&&(d[i]=r[i]);d.formFieldId=i(10)}C(t);const o={};w.forEach((e=>{o[e.id]=e.value})),D.setFieldsValue(o)},children:[t.jsx(r.Item,{label:"id",name:"id",rules:[{required:!0,message:"Please input"}],hidden:!0,children:t.jsx(m,{})}),t.jsx(g,{initFieldBo:P,isEditScope:S})]},"updateForm")]})]})}));export{y as default};
