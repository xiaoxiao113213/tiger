import{r as t,F as e,j as i,B as a,O as s,m as r,Y as o,c as l}from"./index-52537ad8.js";import{otherAccountAllApi as m}from"./api-8573b5cc.js";import{pipelineGetOneApi as d}from"./pipeline-5a55b6de.js";import{serverToClientValue as n,clientToServerValueItem as p}from"./Bo-cc27e439.js";import{pipelineBuildApi as c}from"./pipelineBuildApi-4ee185cc.js";import u from"./submitNowform-370ac6e7.js";import{C as j}from"./index-8d66853c.js";import"./textSubmit-f698ce92.js";import"./textAreaSubmit-9cc0fcd3.js";import"./SelectSubmit-a0546f42.js";import"./MutSelectSubmit-978c5f1c.js";import"./DateSubmit-7515399a.js";import"./NumberSubmit-d54ed6cf.js";import"./FileUploadSubmit-1e28b47f.js";import"./PlusOutlined-0403edcb.js";const f=f=>{const[b,x]=t.useState([]),[y,h]=t.useState(),[S,v]=t.useState([]),[g]=e.useForm();return t.useEffect((()=>((async()=>{m({}).then((t=>{t.data.forEach((t=>t.id=t.id+"")),x(t.data)}));const t=await d({id:f.detailId});1e3===t?.code&&(h(t.data),t.data.globalParamList&&(t.data.globalParamList.forEach((t=>{n(t)})),v(t.data.globalParamList)))})(),()=>{})),[f.detailId]),i.jsxs("div",{children:[y&&y.globalParamList&&i.jsx(j,{title:i.jsx("div",{style:{display:"flex",justifyContent:"space-between"},children:i.jsx("span",{children:"表单"})}),children:i.jsx(e,{form:g,children:S.map((t=>i.jsx(u,{initFieldBo:t},t.id)))})}),i.jsxs(e.Item,{wrapperCol:{offset:12,span:12},style:{marginTop:10},children:[i.jsx(a,{type:"default",onClick:()=>f.setBuildModalFn(s.close),children:"取消"}),i.jsx(a,{type:"primary",htmlType:"submit",onClick:async()=>{try{if(!(await g.validateFields().catch((()=>!1))))return void r.error("请填写必填项");const t=await(g?.getFieldsValue());o(t);let e=S.map((e=>{const i={...e};return i.value=t[e.id],p(i),{keyName:i.keyName,value:i.value}}));const i={};i.pipelineId=y?.id,i.params=e;const a=await c(i);if(l(a))return;r.info("触发成功"),f.reloadTable()}catch(t){}},style:{marginLeft:20},children:"确认"})]})]})};export{f as default};
