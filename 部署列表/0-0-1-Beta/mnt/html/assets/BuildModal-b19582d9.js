import{r as t,F as e,j as i,B as a,O as s,m as r,Y as o,c as l}from"./index-03adb9ee.js";import{otherAccountAllApi as m}from"./api-e992af87.js";import{pipelineGetOneApi as d}from"./pipeline-ea2f224f.js";import{serverToClientValue as n,clientToServerValueItem as p}from"./Bo-c1a8a5bb.js";import{pipelineBuildApi as c}from"./pipelineBuildApi-5c85f8f6.js";import u from"./submitNowform-fbdcf9ab.js";import{C as j}from"./index-3585a1a3.js";import"./textSubmit-bd6c5b40.js";import"./textAreaSubmit-3b52d66b.js";import"./SelectSubmit-4c180fb2.js";import"./MutSelectSubmit-064a257d.js";import"./DateSubmit-95284b79.js";import"./NumberSubmit-77884c9b.js";import"./FileUploadSubmit-e8f92bb2.js";import"./PlusOutlined-b4032aa8.js";const f=f=>{const[b,x]=t.useState([]),[y,h]=t.useState(),[S,v]=t.useState([]),[g]=e.useForm();return t.useEffect((()=>((async()=>{m({}).then((t=>{t.data.forEach((t=>t.id=t.id+"")),x(t.data)}));const t=await d({id:f.detailId});1e3===t?.code&&(h(t.data),t.data.globalParamList&&(t.data.globalParamList.forEach((t=>{n(t)})),v(t.data.globalParamList)))})(),()=>{})),[f.detailId]),i.jsxs("div",{children:[y&&y.globalParamList&&i.jsx(j,{title:i.jsx("div",{style:{display:"flex",justifyContent:"space-between"},children:i.jsx("span",{children:"表单"})}),children:i.jsx(e,{form:g,children:S.map((t=>i.jsx(u,{initFieldBo:t},t.id)))})}),i.jsxs(e.Item,{wrapperCol:{offset:12,span:12},style:{marginTop:10},children:[i.jsx(a,{type:"default",onClick:()=>f.setBuildModalFn(s.close),children:"取消"}),i.jsx(a,{type:"primary",htmlType:"submit",onClick:async()=>{try{if(!(await g.validateFields().catch((()=>!1))))return void r.error("请填写必填项");const t=await(g?.getFieldsValue());o(t);let e=S.map((e=>{const i={...e};return i.value=t[e.id],p(i),{keyName:i.keyName,value:i.value}}));const i={};i.pipelineId=y?.id,i.params=e;const a=await c(i);if(l(a))return;r.info("触发成功"),f.reloadTable()}catch(t){}},style:{marginLeft:20},children:"确认"})]})]})};export{f as default};
