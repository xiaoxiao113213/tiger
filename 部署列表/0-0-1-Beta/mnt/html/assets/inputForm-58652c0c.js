import{F as e,r as t,j as a,e as i,f as n,I as s,C as r,b as l,S as d}from"./index-10719960.js";import{C as o,V as m}from"./ApiBo-d6e5478a.js";import{aiPipelinePointVarUpdateApi as x,aiPipelinePointVarSaveApi as p,aiPipelinePointVarDeleteApi as u}from"./varApi-6204ca1d.js";import{D as c}from"./DeleteOutlined-91444ec2.js";const I=I=>{const{point:g,inputVarList:h,getDetail:j}=I,y=I.title||"输入变量：",[f]=e.useForm(),[k,w]=t.useState();t.useEffect((()=>{g&&w(g.varList.filter((e=>e.category==o.Input)).map(((e,t)=>({key:e.aiPipelinePointVarId.toString(),name:e.name,relatedId:e.relatedId,remarks:e.remarks,defaultValue:e.defaultValue}))))}),[g]),t.useEffect((()=>{const e={};for(let t in k)e[k[t].key+"_name"]=k[t].name,e[k[t].key+"_relatedId"]=k[t].relatedId,e[k[t].key+"_remarks"]=k[t].remarks,e[k[t].key+"_defaultValue"]=k[t].defaultValue;f.setFieldsValue(e)}),[k]);const V=[{title:"变量名",dataIndex:"name",width:"180px",editable:!0},{title:"变量值",dataIndex:"relatedId",width:"130px",editable:!0},{title:"默认值",dataIndex:"defaultValue",editable:!0},{title:"描述",dataIndex:"remarks",editable:!0},{title:"",dataIndex:"operation",width:"30px",render:(e,t)=>I.notDeleteName&&I.notDeleteName.includes(t.name)?a.jsx("div",{}):a.jsx("div",{children:a.jsx(c,{onClick:()=>(async e=>{await u({aiPipelinePointVarId:parseInt(e.key)}),I.getDetail()})(t)})})}].map((e=>{if(!e.editable)return e;let t="text";"type"===e.dataIndex&&(t="select"),"remarks"!==e.dataIndex&&"defaultValue"!==e.dataIndex||(t="textArea");const a=e=>{let t=!0;return"historyMsg"===e.name&&(t=!1),"newMsg"===e.name&&(t=!1),t};return{...e,onCell:i=>({record:i,inputType:t,dataIndex:e.dataIndex,title:e.title,editing:a(i)})}}));return a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",marginBottom:"5px"},children:[a.jsx("div",{children:y}),a.jsx("div",{style:{marginRight:"30px"},children:a.jsx("a",{onClick:()=>(async()=>{await p({aiPipelinePointId:g.aiPipelinePointId,name:n(),type:"string",remarks:"",category:o.Input}),I.getDetail()})(),children:a.jsx("img",{src:"/icons/加号.svg",alt:"icon",style:{width:16,height:16,display:"inline",marginRight:"5px"}})})})]}),a.jsx(e,{form:f,component:!1,onValuesChange:(e,t)=>{for(let a in e){const t=a.split("_"),i=t[0],n=t[1],s=e[a],r={aiPipelinePointVarId:parseInt(i),[n]:s,keyName:n};x(r)}},children:a.jsx(i,{components:{body:{cell:({editing:t,dataIndex:i,title:n,inputType:o,record:x,index:p,children:u,...c})=>{if("变量名"==n)return a.jsx("td",{...c,children:t?a.jsx(e.Item,{name:`${x.key}_${i}`,style:{margin:0},rules:[{required:!0,message:`请输入 ${n}！只能输入英文字符和数字，且以英文字符开头。`},{pattern:/^[a-zA-Z][a-zA-Z0-9]*$/,message:"只能输入英文字符和数字，且以英文字符开头。"}],children:a.jsx(s,{maxLength:20,showCount:!0})}):u});if("变量值"==n)return a.jsx("td",{...c,children:t?a.jsx(e.Item,{name:`${x.key}_${i}`,style:{margin:0},children:a.jsx(r,{options:h,placeholder:"Please select"})}):u});let I="number"===o?a.jsx(l,{}):a.jsx(s,{maxLength:20,showCount:!0});return"select"===o&&(I=a.jsx(d,{options:m})),"textArea"===o&&(I=a.jsx(s.TextArea,{autoSize:{minRows:1,maxRows:6}})),a.jsx("td",{...c,children:t?a.jsx(e.Item,{name:x.key+"_"+i,style:{margin:0},rules:[{required:!1,message:`Please Input ${n}!`}],children:I}):u})}}},bordered:!0,dataSource:k,columns:V,rowClassName:"editable-row",pagination:!1})})]})};export{I as default};
