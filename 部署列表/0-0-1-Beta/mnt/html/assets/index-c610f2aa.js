import{r as e,O as t,i as r,j as o,P as i,B as a,a3 as s,D as l,m as d,T as n,ax as p,M as c,c as m}from"./index-10719960.js";import j from"./detail-fb3b99d7.js";import u from"./addOrUpdate-cd3ac982.js";import{projectPageApi as x,projectCustomFieldAllApi as y,projectCustomFieldSaveApi as h,projectDeleteApi as b}from"./api-20821f6a.js";import{p as T,b as S}from"./projectTypeDic-12cd4771.js";import f from"./formComponent-402c7b18.js";import{serverToClientValue as C,clientToServerValueItem as w}from"./Bo-bcadefc8.js";import I from"./accountSetting-dd8695b9.js";import{b as O}from"./ApiBo-be5b8d9e.js";import{P as g}from"./PlusOutlined-cc4f568a.js";import"./FileView-2fed186d.js";import"./index-24e8ffcd.js";import"./index-be16395f.js";import"./index-4b23e8f2.js";import"./index-30b704bf.js";import"./EditOutlined-34dfcda0.js";import"./dicApi-19a4777b.js";import"./FileUploadCom-c3fb6dc0.js";import"./submitNowform-3ec5b855.js";import"./textSubmit-5aad76e3.js";import"./textAreaSubmit-e3064045.js";import"./SelectSubmit-fba154f7.js";import"./MutSelectSubmit-7d2986fa.js";import"./DateSubmit-7b5457eb.js";import"./NumberSubmit-61c4b5e2.js";import"./FileUploadSubmit-b86f5e72.js";import"./utils-452b7114.js";import"./Title-5ea514a5.js";import"./Input-f4f01092.js";import"./TextArea-8948f20d.js";import"./index-fb93998c.js";import"./FileSubmit-52898802.js";import"./customerFieldNew-bd52e5d5.js";import"./customerText-ab37e497.js";import"./customerTextArea-fdf43c64.js";import"./customerSelect-0b789148.js";import"./MinusCircleOutlined-f32dd4d0.js";import"./MinusCircleOutlined-47af1d51.js";import"./customerMutSelect-2ed19145.js";import"./CustomerFile-b6b47294.js";import"./CustomerDate-c212afd9.js";import"./customerNumber-f42eabd0.js";import"./DeleteOutlined-91444ec2.js";import"./index-c05d5723.js";import"./Password-88bd354d.js";import"./QRCodeSVG-ffc224cf.js";import"./TaobaoOutlined-8cd58809.js";import"./FileZipFilled-2a2025c5.js";import"./BranchesOutlined-c52fb168.js";import"./RightSquareTwoTone-e5897024.js";import"./FileUnknownTwoTone-791de7ab.js";import"./MoreOutlined-49b0b054.js";import"./PlusCircleOutlined-a72eecfb.js";import"./PlusSquareTwoTone-f51424a0.js";import"./RetweetOutlined-9d2a328f.js";import"./SendOutlined-86da6479.js";import"./TableOutlined-67e609f9.js";import"./api-5bb72ee6.js";import"./api-990bd395.js";const k=()=>{const k=e.useRef(),[v,D]=e.useState(t.close),[F,E]=e.useState(),[N,U]=e.useState(t.close),[z,P]=e.useState(!1),R=r.useRef(null),[A,B]=e.useState([]),{projectTypeValueEnum:M}=T(),[q,K]=e.useState(t.close),Q=e=>{E(e.projectId),D(t.detail)},V=e=>{E(e?.projectId),U(e?t.edit:t.add)};e.useEffect((()=>{}),[]);const G=[{title:"ID",dataIndex:"projectId",valueType:"text",copyable:!1,search:!1},{title:"名称",dataIndex:"name",valueType:"text",copyable:!1,search:!1,render:(e,t)=>o.jsx("a",{onClick:()=>Q(t),children:t.name},"detail1")},{title:"类型",dataIndex:"type",valueType:"text",copyable:!1,search:!1,valueEnum:M},{title:"编码",dataIndex:"code",valueType:"text",copyable:!1,search:!1},{title:"状态",dataIndex:"status",valueType:"text",copyable:!1,search:!1,render:(e,{status:t})=>t===S.NotStarted?o.jsx(n,{color:"",children:"未开始"}):t===S.Underway?o.jsx(n,{color:"blue",children:"进行中"}):t===S.Completed?o.jsx(n,{color:"green",children:"已完成"}):t===S.Closed?o.jsx(n,{color:"red",children:"已关闭"}):void 0},{title:"计划开始时间",dataIndex:"planStartDate",valueType:"text",copyable:!1,search:!1,render:(e,{planStartDate:t})=>p(t)},{title:"计划结束时间",dataIndex:"planEndDate",valueType:"text",copyable:!1,search:!1,render:(e,{planEndDate:t})=>p(t)},{title:"开始时间",dataIndex:"startDate",valueType:"text",copyable:!1,search:!1,render:(e,{startDate:t})=>p(t)},{title:"结束时间",dataIndex:"endDate",valueType:"text",copyable:!1,search:!1,render:(e,{endDate:t})=>p(t)},{title:"负责人",dataIndex:"headUserId",valueType:"text",copyable:!1,search:!1,render:(e,t)=>t.headUser?.nickName},{title:"报告人",dataIndex:"reporterUserId",valueType:"text",copyable:!1,search:!1,render:(e,t)=>t.reporterUser?.nickName},{title:"操作",valueType:"option",key:"option",width:160,render:(e,r,i,a)=>[o.jsx("a",{onClick:()=>Q(r),children:"详情"},"detail"),o.jsx("a",{hidden:s("project:edit"),onClick:()=>V(r),children:"编辑"},"edit"),o.jsx("a",{hidden:s("project:del"),onClick:()=>(async e=>{c?.confirm({title:"是否确认删除",icon:null,onOk:async()=>{let t=await b({projectId:e.projectId});m(t)||(d.success(t.msg),k.current?.reload())}})})(r),children:"删除"},"del"),o.jsx("a",{hidden:s("project:permission"),onClick:()=>{E(r.projectId),K(t.add)},children:"人员"},"account")]}];return o.jsxs("div",{children:[o.jsx(i,{columns:G,actionRef:k,cardBordered:!0,params:{},request:async(e={},t,r)=>{let o={pageNum:e.current,pageSize:e.pageSize,pageSort:t},i=await x({...e,...o});return{data:i.data.list,success:1e3===i.code,total:i.data.total}},editable:{type:"multiple"},columnsState:{persistenceKey:"project-pro-table",persistenceType:"localStorage",onChange(e){}},rowKey:"projectId",search:{labelWidth:"auto",defaultCollapsed:!1},options:{setting:{listsHeight:400}},form:{syncToUrl:!1},pagination:{defaultPageSize:10,showSizeChanger:!0},dateFormatter:"string",headerTitle:"列表",toolBarRender:()=>[o.jsx(a,{icon:o.jsx(g,{}),onClick:()=>{V()},type:"primary",hidden:s("project:edit"),children:"新建"},"button"),o.jsx(a,{onClick:async()=>{const e=await y({bizType:"0"});e.data.forEach((e=>{e.id=e.projectCustomFieldId+"";const t=e;t.notEditKeyName=!0,C(t)})),B(e.data),P(!0)},type:"primary",hidden:s("project:form"),children:"定义表单"},"button1")]}),o.jsx(l,{title:"详情",open:v!==t.close,width:"50%",destroyOnClose:!0,maskClosable:!1,onClose:()=>D(t.close),footer:null,children:o.jsx("div",{children:o.jsx(j,{detailId:F})})}),o.jsx(l,{title:N==t.edit?"编辑":"新增",open:N!==t.close,width:"50%",destroyOnClose:!0,maskClosable:!1,onClose:()=>U(t.close),footer:null,children:o.jsx("div",{children:o.jsx(u,{detailId:F??0,operateEnum:N,setAddOrUpdateModalFn:U,reloadTable:()=>{k.current?.reload()}})})}),o.jsx(l,{title:"表单设计",open:z,onClose:()=>P(!1),extra:o.jsx(a,{onClick:async()=>{const e=R.current?.getFieldList();e&&(e.forEach((t=>{if(""===t.keyName)throw d.error("有字段的唯一标识为空"),new Error("有字段的唯一标识为空");const r=e.filter((e=>e.keyName===t.keyName));if(r.length>1)throw d.error(`有重复的唯一标识【${r[0].keyName}】`),new Error(`有重复的唯一标识【${r[0].keyName}】`);t.bizType="0"})),e.forEach((e=>{w(e)})),await h({bizType:"0",list:e}),P(!1))},type:"primary",children:"确定"}),width:"100%",destroyOnClose:!0,children:o.jsx(f,{ref:R,initFormDesign:A})}),o.jsx(l,{title:"项目人员",open:q!==t.close,onClose:()=>K(t.close),width:"80%",destroyOnClose:!0,children:o.jsx(I,{bizType:O.Project,bizTypeId:F,closeFn:()=>K(t.close)})},"accountSetting")]})};export{k as default};
