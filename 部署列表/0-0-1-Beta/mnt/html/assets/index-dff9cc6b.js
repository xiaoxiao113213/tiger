import{r as e,O as t,i as r,j as o,P as i,B as a,a3 as s,D as l,m as d,T as n,aw as p,M as c,c as m}from"./index-f2321b57.js";import j from"./detail-8d80e37d.js";import u from"./addOrUpdate-2299a0c3.js";import{projectPageApi as x,projectCustomFieldAllApi as y,projectCustomFieldSaveApi as h,projectDeleteApi as b}from"./api-3ad5779a.js";import{p as T,b as f}from"./projectTypeDic-e9f01f5f.js";import S from"./formComponent-e31b7955.js";import{serverToClientValue as C,clientToServerValueItem as w}from"./Bo-900708b2.js";import I from"./accountSetting-b2d8b5ee.js";import{b as k}from"./ApiBo-be5b8d9e.js";import{P as g}from"./PlusOutlined-0e19b652.js";import"./FileView-b3b24bb9.js";import"./index-26718f3e.js";import"./index-d54aef2b.js";import"./index-55f4da4c.js";import"./index-e51db6e5.js";import"./EditOutlined-1e526840.js";import"./dicApi-6905b9c5.js";import"./FileUploadCom-3c65d1d1.js";import"./submitNowform-f35e2701.js";import"./textSubmit-4229c5b2.js";import"./textAreaSubmit-14d30dcb.js";import"./SelectSubmit-d0c3571a.js";import"./MutSelectSubmit-d4556965.js";import"./DateSubmit-41050df2.js";import"./NumberSubmit-9c6b3724.js";import"./FileUploadSubmit-a4029aca.js";import"./utils-5a18e36f.js";import"./Title-c989167c.js";import"./Input-f009b856.js";import"./TextArea-47627076.js";import"./index-1e1c35a0.js";import"./FileSubmit-975998bf.js";import"./customerFieldNew-4b477ff0.js";import"./customerText-29c51ee6.js";import"./customerTextArea-c929063a.js";import"./customerSelect-e147971d.js";import"./MinusCircleOutlined-ede52421.js";import"./MinusCircleOutlined-47af1d51.js";import"./customerMutSelect-b7b09c88.js";import"./CustomerFile-0ba717f3.js";import"./CustomerDate-a09fb913.js";import"./customerNumber-e3e13da1.js";import"./DeleteOutlined-10e7bcc5.js";import"./index-20d3ffb0.js";import"./Password-38003184.js";import"./QRCodeSVG-f82b9ee5.js";import"./TaobaoOutlined-8cd58809.js";import"./FileZipFilled-c8d13b2f.js";import"./BranchesOutlined-c52fb168.js";import"./RightSquareTwoTone-e5897024.js";import"./FileUnknownTwoTone-791de7ab.js";import"./MoreOutlined-49b0b054.js";import"./PlusCircleOutlined-a72eecfb.js";import"./PlusSquareTwoTone-f51424a0.js";import"./RetweetOutlined-9d2a328f.js";import"./SendOutlined-86da6479.js";import"./TableOutlined-67e609f9.js";import"./api-df708061.js";import"./api-5c5bfeed.js";const O=()=>{const O=e.useRef(),[v,D]=e.useState(t.close),[F,E]=e.useState(),[N,U]=e.useState(t.close),[z,P]=e.useState(!1),M=r.useRef(null),[R,A]=e.useState([]),{projectTypeValueEnum:B}=T(),[q,K]=e.useState(t.close),Q=e=>{E(e.projectId),D(t.detail)},V=e=>{E(e?.projectId),U(e?t.edit:t.add)};e.useEffect((()=>{}),[]);const G=[{title:"ID",dataIndex:"projectId",valueType:"text",copyable:!1,search:!1},{title:"名称",dataIndex:"name",valueType:"text",copyable:!1,search:!1,render:(e,t)=>o.jsx("a",{onClick:()=>Q(t),children:t.name},"detail1")},{title:"类型",dataIndex:"type",valueType:"text",copyable:!1,search:!1,valueEnum:B},{title:"编码",dataIndex:"code",valueType:"text",copyable:!1,search:!1},{title:"状态",dataIndex:"status",valueType:"text",copyable:!1,search:!1,render:(e,{status:t})=>t===f.NotStarted?o.jsx(n,{color:"",children:"未开始"}):t===f.Underway?o.jsx(n,{color:"blue",children:"进行中"}):t===f.Completed?o.jsx(n,{color:"green",children:"已完成"}):t===f.Closed?o.jsx(n,{color:"red",children:"已关闭"}):void 0},{title:"计划开始时间",dataIndex:"planStartDate",valueType:"text",copyable:!1,search:!1,render:(e,{planStartDate:t})=>p(t)},{title:"计划结束时间",dataIndex:"planEndDate",valueType:"text",copyable:!1,search:!1,render:(e,{planEndDate:t})=>p(t)},{title:"开始时间",dataIndex:"startDate",valueType:"text",copyable:!1,search:!1,render:(e,{startDate:t})=>p(t)},{title:"结束时间",dataIndex:"endDate",valueType:"text",copyable:!1,search:!1,render:(e,{endDate:t})=>p(t)},{title:"负责人",dataIndex:"headUserId",valueType:"text",copyable:!1,search:!1,render:(e,t)=>t.headUser?.nickName},{title:"报告人",dataIndex:"reporterUserId",valueType:"text",copyable:!1,search:!1,render:(e,t)=>t.reporterUser?.nickName},{title:"操作",valueType:"option",key:"option",width:160,render:(e,r,i,a)=>[o.jsx("a",{onClick:()=>Q(r),children:"详情"},"detail"),o.jsx("a",{hidden:s("project:edit"),onClick:()=>V(r),children:"编辑"},"edit"),o.jsx("a",{hidden:s("project:del"),onClick:()=>(async e=>{c?.confirm({title:"是否确认删除",icon:null,onOk:async()=>{let t=await b({projectId:e.projectId});m(t)||(d.success(t.msg),O.current?.reload())}})})(r),children:"删除"},"del"),o.jsx("a",{hidden:s("project:permission"),onClick:()=>{E(r.projectId),K(t.add)},children:"人员"},"account")]}];return o.jsxs("div",{children:[o.jsx(i,{columns:G,actionRef:O,cardBordered:!0,params:{},request:async(e={},t,r)=>{let o={pageNum:e.current,pageSize:e.pageSize,pageSort:t},i=await x({...e,...o});return{data:i.data.list,success:1e3===i.code,total:i.data.total}},editable:{type:"multiple"},columnsState:{persistenceKey:"project-pro-table",persistenceType:"localStorage",onChange(e){}},rowKey:"projectId",search:{labelWidth:"auto",defaultCollapsed:!1},options:{setting:{listsHeight:400}},form:{syncToUrl:!1},pagination:{defaultPageSize:10,showSizeChanger:!0},dateFormatter:"string",headerTitle:"列表",toolBarRender:()=>[o.jsx(a,{icon:o.jsx(g,{}),onClick:()=>{V()},type:"primary",hidden:s("project:edit"),children:"新建"},"button"),o.jsx(a,{onClick:async()=>{const e=await y({bizType:"0"});e.data.forEach((e=>{e.id=e.projectCustomFieldId+"";const t=e;t.notEditKeyName=!0,C(t)})),A(e.data),P(!0)},type:"primary",hidden:s("project:form"),children:"定义表单"},"button1")]}),o.jsx(l,{title:"详情",open:v!==t.close,width:"50%",destroyOnClose:!0,maskClosable:!1,onClose:()=>D(t.close),footer:null,children:o.jsx("div",{children:o.jsx(j,{detailId:F})})}),o.jsx(l,{title:N==t.edit?"编辑":"新增",open:N!==t.close,width:"50%",destroyOnClose:!0,maskClosable:!1,onClose:()=>U(t.close),footer:null,children:o.jsx("div",{children:o.jsx(u,{detailId:F??0,operateEnum:N,setAddOrUpdateModalFn:U,reloadTable:()=>{O.current?.reload()}})})}),o.jsx(l,{title:"表单设计",open:z,onClose:()=>P(!1),extra:o.jsx(a,{onClick:async()=>{const e=M.current?.getFieldList();e&&(e.forEach((t=>{if(""===t.keyName)throw d.error("有字段的唯一标识为空"),new Error("有字段的唯一标识为空");const r=e.filter((e=>e.keyName===t.keyName));if(r.length>1)throw d.error(`有重复的唯一标识【${r[0].keyName}】`),new Error(`有重复的唯一标识【${r[0].keyName}】`);t.bizType="0"})),e.forEach((e=>{w(e)})),await h({bizType:"0",list:e}),P(!1))},type:"primary",children:"确定"}),width:"100%",destroyOnClose:!0,children:o.jsx(S,{ref:M,initFormDesign:R})}),o.jsx(l,{title:"项目人员",open:q!==t.close,onClose:()=>K(t.close),width:"80%",destroyOnClose:!0,children:o.jsx(I,{bizType:k.Project,bizTypeId:F,closeFn:()=>K(t.close)})},"accountSetting")]})};export{O as default};
