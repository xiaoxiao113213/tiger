import{r as e,O as t,i as r,j as o,P as i,B as a,a3 as s,D as l,m as d,T as n,aw as p,M as c,c as m}from"./index-1fe6dff8.js";import j from"./detail-f09d55b8.js";import u from"./addOrUpdate-b0211575.js";import{projectPageApi as x,projectCustomFieldAllApi as y,projectCustomFieldSaveApi as h,projectDeleteApi as b}from"./api-7922a999.js";import{p as T,b as f}from"./projectTypeDic-49d79b9e.js";import S from"./formComponent-27c8784f.js";import{serverToClientValue as C,clientToServerValueItem as w}from"./Bo-9e2098a1.js";import I from"./accountSetting-8ca657ac.js";import{b as k}from"./ApiBo-be5b8d9e.js";import{P as g}from"./PlusOutlined-73232e7a.js";import"./FileView-40a1835a.js";import"./index-ad901ab1.js";import"./index-adfb8488.js";import"./index-262ec5ed.js";import"./index-80d88ab0.js";import"./EditOutlined-fbc989f8.js";import"./dicApi-b68549fb.js";import"./FileUploadCom-a72168c5.js";import"./submitNowform-3c073972.js";import"./textSubmit-0f3171ae.js";import"./textAreaSubmit-d1dfc909.js";import"./SelectSubmit-9d579393.js";import"./MutSelectSubmit-5dc3359d.js";import"./DateSubmit-c557ba41.js";import"./NumberSubmit-de5567a9.js";import"./FileUploadSubmit-add66fc2.js";import"./utils-b346c468.js";import"./Title-952b03be.js";import"./Input-f98aea5e.js";import"./TextArea-08e23fd4.js";import"./index-b78e92bd.js";import"./FileSubmit-0542b294.js";import"./customerFieldNew-8ebcd271.js";import"./customerText-9afb4922.js";import"./customerTextArea-67b7b62e.js";import"./customerSelect-14199e01.js";import"./MinusCircleOutlined-7f40363e.js";import"./MinusCircleOutlined-47af1d51.js";import"./customerMutSelect-773b4206.js";import"./CustomerFile-4ea8258f.js";import"./CustomerDate-7ed6f47b.js";import"./customerNumber-a25d7bcc.js";import"./DeleteOutlined-916130f1.js";import"./index-953dfacc.js";import"./Password-ff2218fe.js";import"./QRCodeSVG-710d84ab.js";import"./TaobaoOutlined-8cd58809.js";import"./FileZipFilled-3c93b810.js";import"./BranchesOutlined-c52fb168.js";import"./RightSquareTwoTone-e5897024.js";import"./FileUnknownTwoTone-791de7ab.js";import"./MoreOutlined-49b0b054.js";import"./PlusCircleOutlined-a72eecfb.js";import"./PlusSquareTwoTone-f51424a0.js";import"./RetweetOutlined-9d2a328f.js";import"./SendOutlined-86da6479.js";import"./TableOutlined-67e609f9.js";import"./api-0a5cfd87.js";import"./api-b0087b33.js";const O=()=>{const O=e.useRef(),[v,D]=e.useState(t.close),[F,E]=e.useState(),[N,U]=e.useState(t.close),[z,P]=e.useState(!1),M=r.useRef(null),[R,A]=e.useState([]),{projectTypeValueEnum:B}=T(),[q,K]=e.useState(t.close),Q=e=>{E(e.projectId),D(t.detail)},V=e=>{E(e?.projectId),U(e?t.edit:t.add)};e.useEffect((()=>{}),[]);const G=[{title:"ID",dataIndex:"projectId",valueType:"text",copyable:!1,search:!1},{title:"名称",dataIndex:"name",valueType:"text",copyable:!1,search:!1,render:(e,t)=>o.jsx("a",{onClick:()=>Q(t),children:t.name},"detail1")},{title:"类型",dataIndex:"type",valueType:"text",copyable:!1,search:!1,valueEnum:B},{title:"编码",dataIndex:"code",valueType:"text",copyable:!1,search:!1},{title:"状态",dataIndex:"status",valueType:"text",copyable:!1,search:!1,render:(e,{status:t})=>t===f.NotStarted?o.jsx(n,{color:"",children:"未开始"}):t===f.Underway?o.jsx(n,{color:"blue",children:"进行中"}):t===f.Completed?o.jsx(n,{color:"green",children:"已完成"}):t===f.Closed?o.jsx(n,{color:"red",children:"已关闭"}):void 0},{title:"计划开始时间",dataIndex:"planStartDate",valueType:"text",copyable:!1,search:!1,render:(e,{planStartDate:t})=>p(t)},{title:"计划结束时间",dataIndex:"planEndDate",valueType:"text",copyable:!1,search:!1,render:(e,{planEndDate:t})=>p(t)},{title:"开始时间",dataIndex:"startDate",valueType:"text",copyable:!1,search:!1,render:(e,{startDate:t})=>p(t)},{title:"结束时间",dataIndex:"endDate",valueType:"text",copyable:!1,search:!1,render:(e,{endDate:t})=>p(t)},{title:"负责人",dataIndex:"headUserId",valueType:"text",copyable:!1,search:!1,render:(e,t)=>t.headUser?.nickName},{title:"报告人",dataIndex:"reporterUserId",valueType:"text",copyable:!1,search:!1,render:(e,t)=>t.reporterUser?.nickName},{title:"操作",valueType:"option",key:"option",width:160,render:(e,r,i,a)=>[o.jsx("a",{onClick:()=>Q(r),children:"详情"},"detail"),o.jsx("a",{hidden:s("project:edit"),onClick:()=>V(r),children:"编辑"},"edit"),o.jsx("a",{hidden:s("project:del"),onClick:()=>(async e=>{c?.confirm({title:"是否确认删除",icon:null,onOk:async()=>{let t=await b({projectId:e.projectId});m(t)||(d.success(t.msg),O.current?.reload())}})})(r),children:"删除"},"del"),o.jsx("a",{hidden:s("project:permission"),onClick:()=>{E(r.projectId),K(t.add)},children:"人员"},"account")]}];return o.jsxs("div",{children:[o.jsx(i,{columns:G,actionRef:O,cardBordered:!0,params:{},request:async(e={},t,r)=>{let o={pageNum:e.current,pageSize:e.pageSize,pageSort:t},i=await x({...e,...o});return{data:i.data.list,success:1e3===i.code,total:i.data.total}},editable:{type:"multiple"},columnsState:{persistenceKey:"project-pro-table",persistenceType:"localStorage",onChange(e){}},rowKey:"projectId",search:{labelWidth:"auto",defaultCollapsed:!1},options:{setting:{listsHeight:400}},form:{syncToUrl:!1},pagination:{defaultPageSize:10,showSizeChanger:!0},dateFormatter:"string",headerTitle:"列表",toolBarRender:()=>[o.jsx(a,{icon:o.jsx(g,{}),onClick:()=>{V()},type:"primary",hidden:s("project:edit"),children:"新建"},"button"),o.jsx(a,{onClick:async()=>{const e=await y({bizType:"0"});e.data.forEach((e=>{e.id=e.projectCustomFieldId+"";const t=e;t.notEditKeyName=!0,C(t)})),A(e.data),P(!0)},type:"primary",hidden:s("project:form"),children:"定义表单"},"button1")]}),o.jsx(l,{title:"详情",open:v!==t.close,width:"50%",destroyOnClose:!0,maskClosable:!1,onClose:()=>D(t.close),footer:null,children:o.jsx("div",{children:o.jsx(j,{detailId:F})})}),o.jsx(l,{title:N==t.edit?"编辑":"新增",open:N!==t.close,width:"50%",destroyOnClose:!0,maskClosable:!1,onClose:()=>U(t.close),footer:null,children:o.jsx("div",{children:o.jsx(u,{detailId:F??0,operateEnum:N,setAddOrUpdateModalFn:U,reloadTable:()=>{O.current?.reload()}})})}),o.jsx(l,{title:"表单设计",open:z,onClose:()=>P(!1),extra:o.jsx(a,{onClick:async()=>{const e=M.current?.getFieldList();e&&(e.forEach((t=>{if(""===t.keyName)throw d.error("有字段的唯一标识为空"),new Error("有字段的唯一标识为空");const r=e.filter((e=>e.keyName===t.keyName));if(r.length>1)throw d.error(`有重复的唯一标识【${r[0].keyName}】`),new Error(`有重复的唯一标识【${r[0].keyName}】`);t.bizType="0"})),e.forEach((e=>{w(e)})),await h({bizType:"0",list:e}),P(!1))},type:"primary",children:"确定"}),width:"100%",destroyOnClose:!0,children:o.jsx(S,{ref:M,initFormDesign:R})}),o.jsx(l,{title:"项目人员",open:q!==t.close,onClose:()=>K(t.close),width:"80%",destroyOnClose:!0,children:o.jsx(I,{bizType:k.Project,bizTypeId:F,closeFn:()=>K(t.close)})},"accountSetting")]})};export{O as default};
