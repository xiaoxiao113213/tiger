import{r as t,j as e,aG as s,T as a,Z as n}from"./index-f2321b57.js";import{dicValueApi as i}from"./dicApi-6905b9c5.js";import{F as o}from"./uilts-e16e3ac3.js";import{T as c}from"./Timeline-170fea38.js";import{L as r}from"./index-b46dae5a.js";const l=()=>{const[e,s]=t.useState([]),[a,n]=t.useState(),[o,c]=t.useState({});return t.useEffect((()=>{(async()=>{let t=await i({code:"process_instance_point_status"});s(t.data);let e={},a={};t.data.forEach((t=>{e[t.value]={text:t.label},a[t.value]=t})),n(a),c(e)})()}),[]),{ProcessInstancePointStatusList:e,ProcessInstancePointStatusMap:a,ProcessInstancePointStatusValueEnum:o}},{Title:d}=n,u=t=>{const{point:n,ProcessInstancePointStatusMap:i}=t;return e.jsxs("div",{className:"mmm-height",children:[e.jsx(d,{level:4,children:n?.name}),e.jsx(r,{itemLayout:"horizontal",dataSource:n.children,renderItem:(t,c)=>e.jsx(r.Item,{children:e.jsx(r.Item.Meta,{avatar:e.jsx("div",{children:e.jsx(s,{style:{backgroundColor:"#2b87db",verticalAlign:"middle"},size:"default",src:t.accountVo.avatar,children:t.accountVo.nickName})}),title:e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:t?.accountVo?.nickName}),n.type!==o.startNode&&e.jsx(a,{color:i[t.status]?.color??"geekblue",children:i[t.status]?.label??"未知"},1)]}),t.endTime]}),description:t?.reason??""})})})]})},m=t=>{const{ProcessInstancePointStatusMap:s}=l();if(!t?.instanceDetail||!t?.instanceDetail?.pointList||!s)return null;const{instanceDetail:a}=t,n=a.pointList;n.forEach((t=>{const e=a.approvalPeopleList.filter((e=>e.processInstancePointId===t.processInstancePointId)).map((t=>({...t})));e.length>0?t.children=e:t.children=[]}));const i=n.find((t=>t.type===o.startNode));i.children=[{accountVo:a?.createByAccount,status:1,endTime:i.endTime}];const r=n.map(((t,a)=>({color:s[t.status]?.color??"geekblue",children:e.jsx(u,{point:t,ProcessInstancePointStatusMap:s})})));return e.jsx("div",{className:"mmm-height",style:{overflowY:"auto"},children:e.jsx(c,{items:r})})};export{m as default};
