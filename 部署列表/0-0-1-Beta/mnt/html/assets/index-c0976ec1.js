import{r as e,O as a,j as t,P as i,B as d,a3 as l,D as n,T as s,M as r,c as o,m as c}from"./index-03adb9ee.js";import p from"./addOrUpdate-a20cfaa1.js";import{applicationAllApi as u}from"./api-d442e634.js";import{dicValueApi as m}from"./dicApi-3ecc5ba9.js";import{modulePageApi as h,moduleDeleteApi as x}from"./api-9a55245e.js";import{P as y}from"./PlusOutlined-b4032aa8.js";const f=()=>{const[a,t]=e.useState([]),[i,d]=e.useState({});return e.useEffect((()=>{(async()=>{let e=await u({});t(e.data.map((e=>({label:e.name,value:e.id}))));let a={};e.data.forEach((e=>{a[e.id]={text:e.name}})),d(a)})()}),[]),{applicationList:a,applicationSearchMap:i}},j=()=>{const[a,t]=e.useState([]),[i,d]=e.useState({});return e.useEffect((()=>{(async()=>{let e=await m({code:"menu-type"});e.data.forEach((e=>e.value=parseInt(e.value))),t(e.data);let a={};e.data.forEach((e=>{a[e.value]={text:e.label}})),d(a)})()}),[]),{MenuTypeList:a,MenuTypeSearchMap:i}},T=()=>{let{MenuTypeSearchMap:u,MenuTypeList:m}=j();const{applicationList:T,applicationSearchMap:g}=f(),I=e.useRef(),[S,v]=e.useState(),[b,w]=e.useState(1),[M,C]=e.useState(a.close),[k,E]=e.useState(),O=e=>{E(void 0),v(e?.id),C(e?a.edit:a.add)};e.useEffect((()=>{}),[]);const F=[{title:"应用",dataIndex:"applicationId",initialValue:"1",hideInTable:!0,valueEnum:g},{title:"名称",dataIndex:"name",valueType:"text",copyable:!1},{title:"类型",dataIndex:"code",valueType:"text",search:!1,render:(e,{type:a})=>{let i=m.find((e=>e.value===a));return t.jsxs(s,{color:i?.color,children:[" ",i?.label,"  "]})}},{title:"权限编码",dataIndex:"permission",valueType:"text",copyable:!0},{title:"路径地址",dataIndex:"component",valueType:"text"},{title:"排序",dataIndex:"sort",valueType:"text",search:!1},{disable:!0,title:"状态",dataIndex:"disabled",search:!1,render:(e,{disabled:a})=>0===a?t.jsx(s,{color:"green",children:"启用"}):t.jsx(s,{color:"red",children:"禁用"})},{disable:!0,title:"展示菜单",dataIndex:"showFlag",search:!1,render:(e,{showFlag:a})=>0===a?t.jsx(s,{color:"red",children:"否"}):t.jsx(s,{color:"green",children:"是"})},{title:"创建时间",key:"showTime",dataIndex:"createTime",valueType:"dateTime",sorter:!0,search:!1},{title:"操作",valueType:"option",key:"option",width:130,render:(e,i,d,n)=>[t.jsx("a",{onClick:()=>O(i),hidden:l("menu:edit"),children:"编辑"},"log"),t.jsx("a",{onClick:()=>{E(i.id),v(void 0),C(a.add)},hidden:l("menu:edit"),children:"添加子"},"addSon"),t.jsx("a",{onClick:()=>(async e=>{r?.confirm({title:"是否确认删除",icon:null,onOk:async()=>{let a=await x({id:e.id});o(a)||(c.success(a.msg),I.current?.reload())}})})(i),hidden:l("menu:del"),children:"删除"},"del")]}];return t.jsxs("div",{children:[t.jsx(i,{columns:F,actionRef:I,cardBordered:!0,params:{},request:async(e={},a,t)=>{w(e.applicationId??1);let i={pageNum:e.current,pageSize:e.pageSize,pageSort:a,applicationId:e.applicationId??1},d=await h({...e,...i});return{data:d.data,success:1e3===d.code}},editable:{type:"multiple"},columnsState:{persistenceKey:"pro-table-singe-demos",persistenceType:"localStorage",onChange(e){}},rowKey:"id",search:{labelWidth:"auto",defaultCollapsed:!1},options:{setting:{listsHeight:400}},form:{syncToUrl:!1},pagination:!1,dateFormatter:"string",headerTitle:"菜单列表",toolBarRender:()=>[t.jsx(d,{icon:t.jsx(y,{}),onClick:()=>{O()},type:"primary",hidden:l("menu:edit"),children:"新建"},"button")]}),t.jsx(n,{title:M==a.edit?"菜单编辑":"菜单新增",open:M!==a.close,width:"50%",destroyOnClose:!0,maskClosable:!1,onClose:()=>C(a.close),footer:null,children:t.jsx("div",{children:t.jsx(p,{detailId:S??0,operateEnum:M,setAddOrUpdateModalFn:C,reloadTable:()=>{I.current?.reload()},applicationId:b,parentId:k})})})]})};export{T as default};
