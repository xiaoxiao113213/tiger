import{F as e,r as a,i as s,j as t,I as r,ac as i,aR as l,B as d,O as n,a9 as o,Y as m,m as u}from"./index-03adb9ee.js";import{taskGetOneApi as c,taskUpdateApi as p,taskSaveApi as x}from"./api-fa7fbf76.js";import{F as f}from"./FileUploadCom-56501644.js";import{f as h,a as j}from"./utils-20c57c3a.js";import"./PlusOutlined-b4032aa8.js";const g=g=>{const[I]=e.useForm(),[w,F]=a.useState(),[C,L]=s.useState(0);if(a.useEffect((()=>((async()=>{if(g.operateEnum===n.edit){let e=await c({taskId:g.detailId});e.data.startTime=o(e.data.startTime),e.data.endTime=o(e.data.endTime),e.data.fileList=h(e.data.fileList),F(e.data),I.setFieldsValue(e.data),L(e.data.progress)}else I.setFieldsValue({}),F({})})(),()=>{})),[]),!w)return t.jsx("div",{});return t.jsx("div",{children:t.jsxs(e,{form:I,children:[t.jsx(e.Item,{label:"名称",name:"name",rules:[{required:!0}],children:t.jsx(r,{placeholder:"请输入",maxLength:200,showCount:!0})}),t.jsx(e.Item,{label:"描述",name:"remarks",rules:[{required:!1}],children:t.jsx(r.TextArea,{placeholder:"请输入",autoSize:{minRows:3,maxRows:5},showCount:!0,maxLength:1e3})}),t.jsx(e.Item,{label:"开始时间",name:"startTime",rules:[{required:!0}],children:t.jsx(i,{format:"YYYY-MM-DD",picker:"date",onChange:(e,a)=>{},placeholder:"请选择开始时间"})}),t.jsx(e.Item,{label:"结束时间",name:"endTime",rules:[{required:!0}],children:t.jsx(i,{format:"YYYY-MM-DD",picker:"date",onChange:(e,a)=>{},placeholder:"请选择结束时间"})}),t.jsxs(e.Item,{label:"进度",name:"progress",rules:[{required:!1}],children:[t.jsx(l,{min:0,max:100,value:C,onChange:L}),C,"%"]}),t.jsx(f,{name:"fileList",label:"附件",required:!1}),t.jsxs(e.Item,{wrapperCol:{offset:8,span:16},style:{textAlign:"right"},children:[t.jsx(d,{type:"default",onClick:()=>{g.setAddOrUpdateModalFn(n.close)},style:{marginRight:20},children:"取消"}),t.jsx(d,{type:"primary",onClick:async()=>{if(!(await I.validateFields().catch((()=>!1))))return;const e=await(I?.getFieldsValue());let a;m(e),a=g.operateEnum===n.edit?await p({...e,taskId:g.detailId,fileList:j(e.fileList),progress:C}):await x({...e,fileList:j(e.fileList),progress:C}),1e3===a.code&&(u.success(a.msg),g.reloadTable(),g.setAddOrUpdateModalFn(n.close))},children:"确定"})]})]})})};export{g as default};
