const t=function(t,n,r,i,a){const u=e(n);if(null!=r&&("number"!=typeof r||r<0||r===Number.POSITIVE_INFINITY))throw new Error("Expected positive finite `index`");if(!(null==i||i.type&&i.children))throw new Error("Expected valid `parent`");if(null==r!=(null==i))throw new Error("Expected both `index` and `parent`");return!!o(t)&&u.call(a,t,r,i)},e=function(t){if(null==t)return r;if("string"==typeof t)return function(t){return n(e);function e(e){return e.tagName===t}}(t);if("object"==typeof t)return function(t){const r=[];let o=-1;for(;++o<t.length;)r[o]=e(t[o]);return n(i);function i(...t){let e=-1;for(;++e<r.length;)if(r[e].apply(this,t))return!0;return!1}}(t);if("function"==typeof t)return n(t);throw new Error("Expected function, string, or array as `test`")};function n(t){return function(e,n,r){return Boolean(o(e)&&t.call(this,e,"number"==typeof n?n:void 0,r||void 0))}}function r(t){return Boolean(t&&"object"==typeof t&&"type"in t&&"element"===t.type&&"tagName"in t&&"string"==typeof t.tagName)}function o(t){return null!==t&&"object"==typeof t&&"type"in t&&"tagName"in t}const i=e((function(t){return"audio"===t.tagName||"canvas"===t.tagName||"embed"===t.tagName||"iframe"===t.tagName||"img"===t.tagName||"math"===t.tagName||"object"===t.tagName||"picture"===t.tagName||"svg"===t.tagName||"video"===t.tagName})),a={}.hasOwnProperty;const u=new Set(["pingback","prefetch","stylesheet"]);const c=e(["a","abbr","area","b","bdi","bdo","br","button","cite","code","data","datalist","del","dfn","em","i","input","ins","kbd","keygen","label","map","mark","meter","noscript","output","progress","q","ruby","s","samp","script","select","small","span","strong","sub","sup","template","textarea","time","u","var","wbr"]),l=e("meta");function f(t){return Boolean("text"===t.type||c(t)||i(t)||function(t){if("element"!==t.type||"link"!==t.tagName)return!1;if(t.properties.itemProp)return!0;const e=t.properties.rel;let n=-1;if(!Array.isArray(e)||0===e.length)return!1;for(;++n<e.length;)if(!u.has(String(e[n])))return!1;return!0}(t)||l(t)&&function(t,e){const n="element"===t.type&&a.call(t.properties,e)&&t.properties[e];return null!=n&&!1!==n}(t,"itemProp"))}const p=/[ \t\n\f\r]/g;function s(t){return"object"==typeof t?"text"===t.type&&h(t.value):h(t)}function h(t){return""===t.replace(p,"")}const d=["pre","script","style","textarea"],m=function(t){if(null==t)return y;if("function"==typeof t)return g(t);if("object"==typeof t)return Array.isArray(t)?function(t){const e=[];let n=-1;for(;++n<t.length;)e[n]=m(t[n]);return g(r);function r(...t){let n=-1;for(;++n<e.length;)if(e[n].apply(this,t))return!0;return!1}}(t):function(t){const e=t;return g(n);function n(n){const r=n;let o;for(o in t)if(r[o]!==e[o])return!1;return!0}}(t);if("string"==typeof t)return function(t){return g(e);function e(e){return e&&e.type===t}}(t);throw new Error("Expected function, string, or object as test")};function g(t){return function(e,n,r){return Boolean(function(t){return null!==t&&"object"==typeof t&&"type"in t}(e)&&t.call(this,e,"number"==typeof n?n:void 0,r||void 0))}}function y(){return!0}const b=["address","article","aside","blockquote","body","br","caption","center","col","colgroup","dd","dialog","dir","div","dl","dt","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","legend","li","li","listing","main","menu","nav","ol","optgroup","option","p","plaintext","pre","section","summary","table","tbody","td","td","tfoot","th","th","thead","tr","ul","wbr","xmp"],v=["button","input","select","textarea"],w=["area","base","basefont","dialog","datalist","head","link","meta","noembed","noframes","param","rp","script","source","style","template","track","title"],x={},N=m(["doctype","comment"]);function A(t,e){if("children"in t){const n={...e};return("root"===t.type||j(t))&&(n.before=!0,n.after=!0),n.whitespace=function(t,e){if("tagName"in t&&t.properties)switch(t.tagName){case"listing":case"plaintext":case"script":case"style":case"xmp":return"pre";case"nobr":return"nowrap";case"pre":return t.properties.wrap?"pre-wrap":"pre";case"td":case"th":return t.properties.noWrap?"nowrap":e.whitespace;case"textarea":return"pre-wrap"}return e.whitespace}(t,e),function(t,e){let n=e.before;const r=e.after,o=t.children;let i=o.length,a=-1;for(;++a<i;){const t=A(o[a],{...e,after:k(o,a,r),before:n});t.remove?(o.splice(a,1),a--,i--):t.ignore||(n=t.stripAtStart),S(o[a])&&(n=!1)}return{ignore:!1,stripAtStart:Boolean(n||r),remove:!1}}(t,n)}if("text"===t.type){if("normal"===e.whitespace)return function(t,e){const n=e.collapse(t.value),r={ignore:!1,stripAtStart:!1,remove:!1};let o=0,i=n.length;e.before&&I(n.charAt(0))&&o++;o!==i&&I(n.charAt(i-1))&&(e.after?i--:r.stripAtStart=!0);o===i?r.remove=!0:t.value=n.slice(o,i);return r}(t,e);"nowrap"===e.whitespace&&(t.value=e.collapse(t.value))}return{ignore:N(t),stripAtStart:!1,remove:!1}}function k(t,e,n){for(;++e<t.length;){const n=t[e];let r=E(n);if(void 0===r&&"children"in n&&!B(n)&&(r=k(n.children,-1)),"boolean"==typeof r)return r}return n}function E(t){if("element"===t.type){if(S(t))return!1;if(j(t))return!0}else if("text"===t.type){if(!s(t))return!1}else if(!N(t))return!1}function S(e){return i(e)||t(e,v)}function j(e){return t(e,b)}function B(e){return Boolean("element"===e.type&&e.properties.hidden)||N(e)||t(e,w)}function I(t){return" "===t||"\n"===t}function P(t){const e=/\r?\n|\r/.exec(t);return e?e[0]:" "}function O(){return" "}const q=[],T=!0,F=!1,M="skip";function V(t,e,n,r){let o;"function"==typeof e&&"function"!=typeof n?(r=n,n=e):o=e;const i=m(o),a=r?-1:1;!function t(o,u,c){const l=o&&"object"==typeof o?o:{};if("string"==typeof l.type){const t="string"==typeof l.tagName?l.tagName:"string"==typeof l.name?l.name:void 0;Object.defineProperty(f,"name",{value:"node ("+o.type+(t?"<"+t+">":"")+")"})}return f;function f(){let l,f,p,s=q;if((!e||i(o,u,c[c.length-1]||void 0))&&(s=function(t){if(Array.isArray(t))return t;if("number"==typeof t)return[T,t];return null==t?q:[t]}(n(o,c)),s[0]===F))return s;if("children"in o&&o.children){const e=o;if(e.children&&s[0]!==M)for(f=(r?e.children.length:-1)+a,p=c.concat(e);f>-1&&f<e.children.length;){const n=e.children[f];if(l=t(n,f,p)(),l[0]===F)return l;f="number"==typeof l[1]?l[1]:f+a}}return s}}(t,void 0,[])()}const W={},Y=function(t){const e=function(t){return e;function e(e){return String(e).replace(/[\t\n\v\f\r ]+/g,t)}}((t||x).newlines?P:O);return function(t){A(t,{collapse:e,whitespace:"normal"})}}({newlines:!0});function $(e){const n=e||W;let r=n.indent||2,o=n.indentInitial;return"number"==typeof r&&(r=" ".repeat(r)),null==o&&(o=!0),function(e){let n;Y(e),V(e,(function(e,a){let u=-1;if(!("children"in e))return;if(t(e,"head")&&(n=!0),n&&t(e,"body")&&(n=void 0),t(e,d))return M;const c=e.children;let l,f=a.length;if(0===c.length||!_(e,n))return;for(o||f--;++u<c.length;){const t=c[u];"text"!==t.type&&"comment"!==t.type||(t.value.includes("\n")&&(l=!0),t.value=t.value.replace(/ *\n/g,"$&"+String(r).repeat(f)))}const p=[];let h;for(u=-1;++u<c.length;){const t=c[u];(_(t,n)||l&&!u)&&(i(p,f,t),l=!0),h=t,p.push(t)}h&&(l||_(h,n))&&(s(h)&&(p.pop(),h=p[p.length-1]),i(p,f-1)),e.children=p}))};function i(t,e,n){const o=t[t.length-1],i=(a(o&&s(o)?t[t.length-2]:o)&&a(n)?"\n\n":"\n")+String(r).repeat(Math.max(e,0));o&&"text"===o.type?o.value=s(o)?i:o.value+i:t.push({type:"text",value:i})}function a(t){return Boolean(t&&"element"===t.type&&n.blanks&&n.blanks.length>0&&n.blanks.includes(t.tagName))}}function _(e,n){return"root"===e.type||"element"===e.type&&(n||t(e,"script")||i(e)||!f(e))}export{$ as default};
