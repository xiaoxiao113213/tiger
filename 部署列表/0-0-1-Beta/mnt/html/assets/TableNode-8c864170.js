import{i as e,r as a,O as s,j as l,aa as d,h as t,B as i,a3 as n,D as o,M as r,c,m}from"./index-1fe6dff8.js";import{KeyIcon as x}from"./KeyIcon-a12c9f5c.js";import{TextNode as j}from"./TextNode-998c3614.js";import h from"./TableTag-7e37ffe7.js";import{tableDeleteApi as b,tableCopyApi as p}from"./api-a8f9de29.js";import{M as u}from"./MoreOutlined-bbcb7d9f.js";const y={table:f,text:j},v=e.createContext({reloadTableData:e=>{},setOpenDrawer:e=>{},deleteTable:e=>{}}),f=e=>{const{data:j,selected:y}=e,f=e.id,g=j.databaseBoardId,[k,_]=a.useState(s.close),{reloadTableData:T,setOpenDrawer:C,deleteTable:N}=a.useContext(v),O=()=>{_(s.close),C(!1),T(f)},I=async()=>{r?.confirm({title:"是否确认删除",icon:null,onOk:async()=>{let e=await b({tableId:f});c(e)||(m.success(e.msg),_(s.close),C(!1),N(f))}})},M=async()=>{let e=await p({tableId:f});c(e)||T(e.data)},w=a.useMemo((()=>l.jsx(d,{trigger:"hover",title:j.description??"",children:l.jsx("div",{children:l.jsxs("div",{className:"table",style:{backgroundColor:y?"#d4dee6":"white"},onDoubleClick:()=>{_(s.add),C(!0)},children:[l.jsxs("div",{style:{backgroundColor:j.schemaColor,display:"flex"},className:"table__name",children:[l.jsx("div",{style:{flex:10},children:j.name}),l.jsx("div",{style:{color:"blue",flex:1,cursor:"default"},children:l.jsx(t,{trigger:"click",placement:"rightTop",content:l.jsxs("div",{children:[l.jsx("div",{children:l.jsx(i,{type:"link",onClick:()=>{_(s.add),C(!0)},hidden:n("databaseBoard:edit"),children:"修改"})}),l.jsx("div",{children:l.jsx(i,{type:"link",onClick:I,hidden:n("databaseBoard:edit"),children:"删除"})}),l.jsx("div",{children:l.jsx(i,{type:"link",onClick:M,hidden:n("databaseBoard:edit"),children:"复制"})})]}),children:l.jsx(u,{})})})]}),l.jsx("div",{className:"table__columns",children:j.columns.map(((e,a)=>l.jsxs("div",{className:"column-name__inner",children:[l.jsxs("div",{className:"column-name__name",style:{display:"flex",alignItems:"center"},children:[e.name,"  ",e.key&&l.jsx(x,{})]}),l.jsx("div",{className:"column-name__type",children:e.type})]},a)))})]},f)})})),[j,y]);return l.jsxs(l.Fragment,{children:[w,l.jsx(o,{title:"表结构",open:k!==s.close,width:"100%",destroyOnClose:!0,maskClosable:!1,keyboard:!0,onClose:O,footer:null,children:l.jsx("div",{children:l.jsx(h,{tableId:f,databaseBoardId:g,closeTableTagModal:O})})},"1222232")]})},g=Object.freeze(Object.defineProperty({__proto__:null,TableNode:f},Symbol.toStringTag,{value:"Module"}));export{v as M,g as T,y as n};
