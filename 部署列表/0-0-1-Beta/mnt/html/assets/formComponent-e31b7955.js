import{r as e,N as i,F as r,j as t,Q as s,V as d,W as o,h as n,B as l,m as a,ab as p,I as m,f as c}from"./index-f2321b57.js";import{d as u}from"./Title-c989167c.js";import{FormFieldTypeEnum as f}from"./Bo-900708b2.js";import x from"./index-1e1c35a0.js";import g from"./customerFieldNew-4b477ff0.js";import{C as j}from"./index-e51db6e5.js";import{D as h}from"./DeleteOutlined-10e7bcc5.js";import"./Input-f009b856.js";import"./TextArea-47627076.js";import"./textSubmit-4229c5b2.js";import"./textAreaSubmit-14d30dcb.js";import"./SelectSubmit-d0c3571a.js";import"./MutSelectSubmit-d4556965.js";import"./FileSubmit-975998bf.js";import"./PlusOutlined-0e19b652.js";import"./DateSubmit-41050df2.js";import"./NumberSubmit-9c6b3724.js";import"./customerText-29c51ee6.js";import"./customerTextArea-c929063a.js";import"./customerSelect-e147971d.js";import"./MinusCircleOutlined-ede52421.js";import"./MinusCircleOutlined-47af1d51.js";import"./customerMutSelect-b7b09c88.js";import"./CustomerFile-0ba717f3.js";import"./CustomerDate-a09fb913.js";import"./customerNumber-e3e13da1.js";const b=[{id:"input-1",name:"文本框",type:f.text,value:""},{id:"select-1",name:"数字框",type:f.number,value:""},{id:"textarea-1",name:"文本域",type:f.textArea,value:""},{id:"select-2",name:"下拉单选",type:f.select,value:""},{id:"select-3",name:"下拉多选",type:f.mutSelect,value:[]},{id:"file-1",name:"文件",type:f.file,value:{fileList:[]}},{id:"date-1",name:"时间",type:f.date,value:void 0}],y=e.forwardRef(((f,y)=>{const{excludedControls:v}=f,F=f.showScope??!1,S=f.isEditScope??!0,[I]=e.useState(b.filter((e=>!(v??[]).includes(e.type)))),[w,C]=e.useState([]);e.useEffect((()=>{f.initFormDesign&&(f.initFormDesign.forEach((e=>{e.formFieldId=i(10)})),C(f.initFormDesign))}),[]);const[D]=r.useForm(),[A]=r.useForm(),[P,R]=e.useState();return e.useImperativeHandle(y,(()=>({getFieldList:()=>w}))),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"20px",backgroundColor:"#f0f0f0",minHeight:"500px"},children:[t.jsx(s,{onDragEnd:e=>{const{source:r,destination:t}=e;if(t){if("controls"===r.droppableId&&"formDesign"===t.droppableId){const e=I[r.index];let s;F&&(s=0);const d={keyName:c(),optional:[],desc:"",notNull:1,scope:s,dateType:0,unit:void 0,...e,id:i(10),formFieldId:i(10)},o=[...w];o.splice(t.index,0,d),C(o)}if("formDesign"===r.droppableId&&"formDesign"===t.droppableId){const e=Array.from(w),[i]=e.splice(r.index,1);e.splice(t.index,0,i),C(e)}}},children:t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flex:1},children:[t.jsx(d,{droppableId:"controls",isDropDisabled:!0,children:e=>t.jsxs("div",{...e.droppableProps,ref:e.innerRef,style:{width:200,padding:10,backgroundColor:"#f8f8f8",borderRadius:"4px"},children:[t.jsx(u,{level:4,style:{textAlign:"center",marginBottom:"20px"},children:"控件选项"}),I.map(((e,i)=>t.jsx(o,{draggableId:e.id,index:i,children:i=>t.jsx("div",{ref:i.innerRef,...i.draggableProps,...i.dragHandleProps,style:{padding:10,margin:"0 0 10px 0",background:"#fff",border:"1px solid #ccc",borderRadius:"4px",...i.draggableProps.style},children:e.name})},e.id))),e.placeholder]})}),t.jsx(j,{style:{width:"100%",margin:"0 20px",background:"#f8f8f8"},children:t.jsx(d,{droppableId:"formDesign",children:e=>t.jsxs("div",{...e.droppableProps,ref:e.innerRef,style:{width:"100%",paddingLeft:10,paddingRight:10,background:"rgba(255, 255, 255, 0.8)",borderRadius:"4px"},children:[t.jsxs(r,{form:D,validateTrigger:"false",style:{width:"100%",height:"100%",marginBottom:"20px"},onValuesChange:(e,i)=>{w.forEach((i=>{e.hasOwnProperty(i.id)&&(i.value=e[i.id])})),C(w)},children:[t.jsx(u,{level:4,style:{textAlign:"center"},children:"表单"}),w.length>0?w.map(((e,i)=>t.jsx(o,{draggableId:e.formFieldId,index:i,children:i=>t.jsx(n,{trigger:"contextMenu",placement:"rightTop",content:t.jsx(l,{icon:t.jsx(h,{}),onClick:()=>{const i=w.find((i=>i.id===e.id));if(i&&i.scope&&!S)return void a.error("插件全局参数不允许删除");const r=w.filter((i=>i.id!==e.id));C(r)}}),children:t.jsx("div",{onClick:()=>{const i=w.find((i=>i.id===e.id));i&&i.scope&&!S||(R(e),A?.setFieldsValue(e))},ref:i.innerRef,...i.draggableProps,...i.dragHandleProps,style:{borderLeft:P?.id===e.id?"5px solid #8AA6EA":"none",borderRight:P?.id===e.id?"5px solid #8AA6EA":"none",borderTop:"none",borderBottom:"none",borderRadius:5,...i.draggableProps.style},children:t.jsx(x,{initFieldBo:e},e.id)})})},e.formFieldId))):t.jsx("p",{children:"拖拽控件到这里"})]},"addFrom"),t.jsx(p,{}),e.placeholder]})})})]})}),t.jsxs("div",{style:{width:300,padding:10,background:"#f8f8f8",border:"1px solid #ccc",borderRadius:"4px",overflowY:"auto"},children:[t.jsx("h3",{children:"属性展示"}),P&&t.jsxs(r,{form:A,validateTrigger:"false",style:{width:"100%",height:"100%"},onValuesChange:(e,r)=>{const t=[...w],s=r.id,d=t.find((e=>e.id===s));if(d){for(let i in d)e.hasOwnProperty(i)&&(d[i]=r[i]);d.formFieldId=i(10)}C(t);const o={};w.forEach((e=>{o[e.id]=e.value})),D.setFieldsValue(o)},children:[t.jsx(r.Item,{label:"id",name:"id",rules:[{required:!0,message:"Please input"}],hidden:!0,children:t.jsx(m,{})}),t.jsx(g,{initFieldBo:P,isEditScope:S})]},"updateForm")]})]})}));export{y as default};
