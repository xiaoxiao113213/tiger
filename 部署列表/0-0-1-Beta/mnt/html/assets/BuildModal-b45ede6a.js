import{r as t,F as e,j as i,B as a,O as s,m as r,Y as o,c as l}from"./index-10719960.js";import{otherAccountAllApi as m}from"./api-7031d208.js";import{pipelineGetOneApi as d}from"./pipeline-be6907e2.js";import{serverToClientValue as n,clientToServerValueItem as p}from"./Bo-bcadefc8.js";import{pipelineBuildApi as c}from"./pipelineBuildApi-80d6901c.js";import u from"./submitNowform-3ec5b855.js";import{C as j}from"./index-30b704bf.js";import"./textSubmit-5aad76e3.js";import"./textAreaSubmit-e3064045.js";import"./SelectSubmit-fba154f7.js";import"./MutSelectSubmit-7d2986fa.js";import"./DateSubmit-7b5457eb.js";import"./NumberSubmit-61c4b5e2.js";import"./FileUploadSubmit-b86f5e72.js";import"./PlusOutlined-cc4f568a.js";const f=f=>{const[b,x]=t.useState([]),[y,h]=t.useState(),[S,v]=t.useState([]),[g]=e.useForm();return t.useEffect((()=>((async()=>{m({}).then((t=>{t.data.forEach((t=>t.id=t.id+"")),x(t.data)}));const t=await d({id:f.detailId});1e3===t?.code&&(h(t.data),t.data.globalParamList&&(t.data.globalParamList.forEach((t=>{n(t)})),v(t.data.globalParamList)))})(),()=>{})),[f.detailId]),i.jsxs("div",{children:[y&&y.globalParamList&&i.jsx(j,{title:i.jsx("div",{style:{display:"flex",justifyContent:"space-between"},children:i.jsx("span",{children:"表单"})}),children:i.jsx(e,{form:g,children:S.map((t=>i.jsx(u,{initFieldBo:t},t.id)))})}),i.jsxs(e.Item,{wrapperCol:{offset:12,span:12},style:{marginTop:10},children:[i.jsx(a,{type:"default",onClick:()=>f.setBuildModalFn(s.close),children:"取消"}),i.jsx(a,{type:"primary",htmlType:"submit",onClick:async()=>{try{if(!(await g.validateFields().catch((()=>!1))))return void r.error("请填写必填项");const t=await(g?.getFieldsValue());o(t);let e=S.map((e=>{const i={...e};return i.value=t[e.id],p(i),{keyName:i.keyName,value:i.value}}));const i={};i.pipelineId=y?.id,i.params=e;const a=await c(i);if(l(a))return;r.info("触发成功"),f.reloadTable()}catch(t){}},style:{marginLeft:20},children:"确认"})]})]})};export{f as default};
