import{aU as t}from"./index-f2321b57.js";import{e}from"./index-aaa2f117.js";import{s as n}from"./index-f5cec5c0.js";function r(t){if(t)throw t}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const o=t((function(t){return null!=t&&null!=t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}));function i(t){if("object"!=typeof t||null===t)return!1;const e=Object.getPrototypeOf(t);return!(null!==e&&e!==Object.prototype&&null!==Object.getPrototypeOf(e)||Symbol.toStringTag in t||Symbol.iterator in t)}function s(){const t=[],e={run:function(...e){let n=-1;const r=e.pop();if("function"!=typeof r)throw new TypeError("Expected function as last argument, not "+r);!function o(i,...s){const c=t[++n];let f=-1;if(i)r(i);else{for(;++f<e.length;)null!==s[f]&&void 0!==s[f]||(s[f]=e[f]);e=s,c?function(t,e){let n;return r;function r(...e){const r=t.length>e.length;let c;r&&e.push(o);try{c=t.apply(this,e)}catch(i){if(r&&n)throw i;return o(i)}r||(c&&c.then&&"function"==typeof c.then?c.then(s,o):c instanceof Error?o(c):s(c))}function o(t,...r){n||(n=!0,e(t,...r))}function s(t){o(null,t)}}(c,o)(...s):r(null,...s)}}(null,...e)},use:function(n){if("function"!=typeof n)throw new TypeError("Expected `middelware` to be a function, not "+n);return t.push(n),e}};return e}class c extends Error{constructor(t,e,r){const o=[null,null];let i={start:{line:null,column:null},end:{line:null,column:null}};if(super(),"string"==typeof e&&(r=e,e=void 0),"string"==typeof r){const t=r.indexOf(":");-1===t?o[1]=r:(o[0]=r.slice(0,t),o[1]=r.slice(t+1))}e&&("type"in e||"position"in e?e.position&&(i=e.position):"start"in e||"end"in e?i=e:("line"in e||"column"in e)&&(i.start=e)),this.name=n(e)||"1:1",this.message="object"==typeof t?t.message:t,this.stack="","object"==typeof t&&t.stack&&(this.stack=t.stack),this.reason=this.message,this.fatal,this.line=i.start.line,this.column=i.start.column,this.position=i,this.source=o[0],this.ruleId=o[1],this.file,this.actual,this.expected,this.url,this.note}}c.prototype.file="",c.prototype.name="",c.prototype.reason="",c.prototype.message="",c.prototype.stack="",c.prototype.fatal=null,c.prototype.column=null,c.prototype.line=null,c.prototype.source=null,c.prototype.ruleId=null,c.prototype.position=null;const f={basename:function(t,e){if(void 0!==e&&"string"!=typeof e)throw new TypeError('"ext" argument must be a string');l(t);let n,r=0,o=-1,i=t.length;if(void 0===e||0===e.length||e.length>t.length){for(;i--;)if(47===t.charCodeAt(i)){if(n){r=i+1;break}}else o<0&&(n=!0,o=i+1);return o<0?"":t.slice(r,o)}if(e===t)return"";let s=-1,c=e.length-1;for(;i--;)if(47===t.charCodeAt(i)){if(n){r=i+1;break}}else s<0&&(n=!0,s=i+1),c>-1&&(t.charCodeAt(i)===e.charCodeAt(c--)?c<0&&(o=i):(c=-1,o=s));r===o?o=s:o<0&&(o=t.length);return t.slice(r,o)},dirname:function(t){if(l(t),0===t.length)return".";let e,n=-1,r=t.length;for(;--r;)if(47===t.charCodeAt(r)){if(e){n=r;break}}else e||(e=!0);return n<0?47===t.charCodeAt(0)?"/":".":1===n&&47===t.charCodeAt(0)?"//":t.slice(0,n)},extname:function(t){l(t);let e,n=t.length,r=-1,o=0,i=-1,s=0;for(;n--;){const c=t.charCodeAt(n);if(47!==c)r<0&&(e=!0,r=n+1),46===c?i<0?i=n:1!==s&&(s=1):i>-1&&(s=-1);else if(e){o=n+1;break}}if(i<0||r<0||0===s||1===s&&i===r-1&&i===o+1)return"";return t.slice(i,r)},join:function(...t){let e,n=-1;for(;++n<t.length;)l(t[n]),t[n]&&(e=void 0===e?t[n]:e+"/"+t[n]);return void 0===e?".":function(t){l(t);const e=47===t.charCodeAt(0);let n=function(t,e){let n,r,o="",i=0,s=-1,c=0,f=-1;for(;++f<=t.length;){if(f<t.length)n=t.charCodeAt(f);else{if(47===n)break;n=47}if(47===n){if(s===f-1||1===c);else if(s!==f-1&&2===c){if(o.length<2||2!==i||46!==o.charCodeAt(o.length-1)||46!==o.charCodeAt(o.length-2))if(o.length>2){if(r=o.lastIndexOf("/"),r!==o.length-1){r<0?(o="",i=0):(o=o.slice(0,r),i=o.length-1-o.lastIndexOf("/")),s=f,c=0;continue}}else if(o.length>0){o="",i=0,s=f,c=0;continue}e&&(o=o.length>0?o+"/..":"..",i=2)}else o.length>0?o+="/"+t.slice(s+1,f):o=t.slice(s+1,f),i=f-s-1;s=f,c=0}else 46===n&&c>-1?c++:c=-1}return o}(t,!e);0!==n.length||e||(n=".");n.length>0&&47===t.charCodeAt(t.length-1)&&(n+="/");return e?"/"+n:n}(e)},sep:"/"};function l(t){if("string"!=typeof t)throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const u={cwd:function(){return"/"}};function a(t){return null!==t&&"object"==typeof t&&t.href&&t.origin}function h(t){if("string"==typeof t)t=new URL(t);else if(!a(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if("file:"!==t.protocol){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return function(t){if(""!==t.hostname){const t=new TypeError('File URL host must be "localhost" or empty on darwin');throw t.code="ERR_INVALID_FILE_URL_HOST",t}const e=t.pathname;let n=-1;for(;++n<e.length;)if(37===e.charCodeAt(n)&&50===e.charCodeAt(n+1)){const t=e.charCodeAt(n+2);if(70===t||102===t){const t=new TypeError("File URL path must not include encoded / characters");throw t.code="ERR_INVALID_FILE_URL_PATH",t}}return decodeURIComponent(e)}(t)}const p=["history","path","basename","stem","extname","dirname"];class y{constructor(t){let e;e=t?"string"==typeof t||function(t){return o(t)}(t)?{value:t}:a(t)?{path:t}:t:{},this.data={},this.messages=[],this.history=[],this.cwd=u.cwd(),this.value,this.stored,this.result,this.map;let n,r=-1;for(;++r<p.length;){const t=p[r];t in e&&void 0!==e[t]&&null!==e[t]&&(this[t]="history"===t?[...e[t]]:e[t])}for(n in e)p.includes(n)||(this[n]=e[n])}get path(){return this.history[this.history.length-1]}set path(t){a(t)&&(t=h(t)),d(t,"path"),this.path!==t&&this.history.push(t)}get dirname(){return"string"==typeof this.path?f.dirname(this.path):void 0}set dirname(t){g(this.basename,"dirname"),this.path=f.join(t||"",this.basename)}get basename(){return"string"==typeof this.path?f.basename(this.path):void 0}set basename(t){d(t,"basename"),m(t,"basename"),this.path=f.join(this.dirname||"",t)}get extname(){return"string"==typeof this.path?f.extname(this.path):void 0}set extname(t){if(m(t,"extname"),g(this.dirname,"extname"),t){if(46!==t.charCodeAt(0))throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=f.join(this.dirname,this.stem+(t||""))}get stem(){return"string"==typeof this.path?f.basename(this.path,this.extname):void 0}set stem(t){d(t,"stem"),m(t,"stem"),this.path=f.join(this.dirname||"",t+(this.extname||""))}toString(t){return(this.value||"").toString(t||void 0)}message(t,e,n){const r=new c(t,e,n);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r}info(t,e,n){const r=this.message(t,e,n);return r.fatal=null,r}fail(t,e,n){const r=this.message(t,e,n);throw r.fatal=!0,r}}function m(t,e){if(t&&t.includes(f.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+f.sep+"`")}function d(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function g(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}const w=function t(){const n=s(),c=[];let f,l={},u=-1;return a.data=function(t,e){if("string"==typeof t)return 2===arguments.length?(C("data",f),l[t]=e,a):b.call(l,t)&&l[t]||null;if(t)return C("data",f),l=t,a;return l},a.Parser=void 0,a.Compiler=void 0,a.freeze=function(){if(f)return a;for(;++u<c.length;){const[t,...e]=c[u];if(!1===e[0])continue;!0===e[0]&&(e[0]=void 0);const r=t.call(a,...e);"function"==typeof r&&n.use(r)}return f=!0,u=Number.POSITIVE_INFINITY,a},a.attachers=c,a.use=function(t,...n){let r;if(C("use",f),null==t);else if("function"==typeof t)h(t,...n);else{if("object"!=typeof t)throw new TypeError("Expected usable value, not `"+t+"`");Array.isArray(t)?u(t):s(t)}r&&(l.settings=Object.assign(l.settings||{},r));return a;function o(t){if("function"==typeof t)h(t);else{if("object"!=typeof t)throw new TypeError("Expected usable value, not `"+t+"`");if(Array.isArray(t)){const[e,...n]=t;h(e,...n)}else s(t)}}function s(t){u(t.plugins),t.settings&&(r=Object.assign(r||{},t.settings))}function u(t){let e=-1;if(null==t);else{if(!Array.isArray(t))throw new TypeError("Expected a list of plugins, not `"+t+"`");for(;++e<t.length;){o(t[e])}}}function h(t,n){let r,o=-1;for(;++o<c.length;)if(c[o][0]===t){r=c[o];break}r?(i(r[1])&&i(n)&&(n=e(!0,r[1],n)),r[1]=n):c.push([...arguments])}},a.parse=function(t){a.freeze();const e=j(t),n=a.Parser;if(A("parse",n),E(n,"parse"))return new n(String(e),e).parse();return n(String(e),e)},a.stringify=function(t,e){a.freeze();const n=j(e),r=a.Compiler;if(x("stringify",r),v(t),E(r,"compile"))return new r(t,n).compile();return r(t,n)},a.run=function(t,e,r){v(t),a.freeze(),r||"function"!=typeof e||(r=e,e=void 0);if(!r)return new Promise(o);function o(o,i){function s(e,n,s){n=n||t,e?i(e):o?o(n):r(null,n,s)}n.run(t,j(e),s)}o(null,r)},a.runSync=function(t,e){let n,o;return a.run(t,e,i),T("runSync","run",o),n;function i(t,e){r(t),n=e,o=!0}},a.process=function(t,e){if(a.freeze(),A("process",a.Parser),x("process",a.Compiler),!e)return new Promise(n);function n(n,r){const i=j(t);function s(t,o){t||!o?r(t):n?n(o):e(null,o)}a.run(a.parse(i),i,((t,e,n)=>{if(!t&&e&&n){const i=a.stringify(e,n);null==i||("string"==typeof(r=i)||o(r)?n.value=i:n.result=i),s(t,n)}else s(t);var r}))}n(null,e)},a.processSync=function(t){let e;a.freeze(),A("processSync",a.Parser),x("processSync",a.Compiler);const n=j(t);return a.process(n,o),T("processSync","process",e),n;function o(t){e=!0,r(t)}},a;function a(){const n=t();let r=-1;for(;++r<c.length;)n.use(...c[r]);return n.data(e(!0,{},l)),n}}().freeze(),b={}.hasOwnProperty;function E(t,e){return"function"==typeof t&&t.prototype&&(function(t){let e;for(e in t)if(b.call(t,e))return!0;return!1}(t.prototype)||e in t.prototype)}function A(t,e){if("function"!=typeof e)throw new TypeError("Cannot `"+t+"` without `Parser`")}function x(t,e){if("function"!=typeof e)throw new TypeError("Cannot `"+t+"` without `Compiler`")}function C(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function v(t){if(!i(t)||"string"!=typeof t.type)throw new TypeError("Expected node, got `"+t+"`")}function T(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function j(t){return function(t){return Boolean(t&&"object"==typeof t&&"message"in t&&"messages"in t)}(t)?t:new y(t)}export{w as unified};
