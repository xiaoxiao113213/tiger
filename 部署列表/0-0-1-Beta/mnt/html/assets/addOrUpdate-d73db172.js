import{F as e,r as a,j as s,b as t,S as l,I as i,B as r,O as d,m as o}from"./index-52537ad8.js";import{workLogGetOneApi as n,workLogUpdateApi as m,workLogSaveApi as u}from"./api-14db96b9.js";import{projectIssueDicApi as c}from"./api-2b18985a.js";import{F as p}from"./FileUploadCom-4d839597.js";import{f,a as x}from"./utils-490c67f2.js";import"./PlusOutlined-0403edcb.js";const h=h=>{const[j]=e.useForm(),[w,y]=a.useState(),[F,I]=a.useState();if(a.useEffect((()=>((async()=>{if(h.operateEnum===d.edit){let e=await n({workLogId:h.detailId});e.data.fileList=f(e.data.fileList),y(e.data),j.setFieldsValue(e.data)}else j.setFieldsValue({day:h.day}),y({day:h.day});let e=await c({});I(e.data)})(),()=>{})),[]),!F)return null;return s.jsx("div",{children:s.jsxs(e,{form:j,labelCol:{flex:"100px"},children:[s.jsx(e.Item,{label:"工时",name:"hours",rules:[{required:!0}],children:s.jsx(t,{placeholder:"请输入",suffix:"小时",style:{width:"200px"}})}),s.jsx(e.Item,{label:"issue",name:"projectIssueId",rules:[{required:!0}],children:s.jsx(l,{placeholder:"请输入",showSearch:!0,options:F,optionFilterProp:"label"})}),s.jsx(e.Item,{label:"描述",name:"remarks",rules:[{required:!0}],children:s.jsx(i.TextArea,{placeholder:"请输入",maxLength:1900,showCount:!0,autoSize:{minRows:3,maxRows:5}})}),s.jsx(p,{name:"fileList",label:"附件",required:!1}),s.jsxs(e.Item,{wrapperCol:{offset:8,span:16},style:{textAlign:"right"},children:[s.jsx(r,{type:"default",onClick:()=>{h.setAddOrUpdateModalFn(d.close)},style:{marginRight:20},children:"取消"}),s.jsx(r,{type:"primary",onClick:async()=>{if(!(await j.validateFields().catch((()=>!1))))return;const e=await(j?.getFieldsValue());let a;e.fileList=x(e.fileList),a=h.operateEnum===d.edit?await m({...e,workLogId:h.detailId}):await u({...e,day:h.day}),1e3===a.code&&(o.success(a.msg),h.reloadTable(),h.setAddOrUpdateModalFn(d.close))},children:"确定"})]})]})})};export{h as default};
