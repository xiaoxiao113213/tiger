import{r as e,A as t,_ as n,O as i,j as s,D as r,i as l,aa as o,B as a,c}from"./index-10719960.js";import{u as d,j as p,E as x}from"./index-937e9b10.js";import{M as h,F as j}from"./uilts-00b5353e.js";import{processPointSaveApi as g,processPointSaveEndApi as u}from"./pointApi-99d1ac8e.js";import{P as k}from"./PlusSquareTwoTone-f51424a0.js";var v=function(i,s){return e.createElement(t,n({},i,{ref:s,icon:k}))};
/**![plus-square](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIGZpbGw9IiNjYWNhY2EiIHZpZXdCb3g9IjY0IDY0IDg5NiA4OTYiIGZvY3VzYWJsZT0iZmFsc2UiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTg4MCAxMTJIMTQ0Yy0xNy43IDAtMzIgMTQuMy0zMiAzMnY3MzZjMCAxNy43IDE0LjMgMzIgMzIgMzJoNzM2YzE3LjcgMCAzMi0xNC4zIDMyLTMyVjE0NGMwLTE3LjctMTQuMy0zMi0zMi0zMnptLTQwIDcyOEgxODRWMTg0aDY1NnY2NTZ6IiBmaWxsPSIjMTY3N2ZmIiAvPjxwYXRoIGQ9Ik0xODQgODQwaDY1NlYxODRIMTg0djY1NnptMTM2LTM1MmMwLTQuNCAzLjYtOCA4LThoMTUyVjMyOGMwLTQuNCAzLjYtOCA4LThoNDhjNC40IDAgOCAzLjYgOCA4djE1MmgxNTJjNC40IDAgOCAzLjYgOCA4djQ4YzAgNC40LTMuNiA4LTggOEg1NDR2MTUyYzAgNC40LTMuNiA4LTggOGgtNDhjLTQuNCAwLTgtMy42LTgtOFY1NDRIMzI4Yy00LjQgMC04LTMuNi04LTh2LTQ4eiIgZmlsbD0iI2U2ZjRmZiIgLz48cGF0aCBkPSJNMzI4IDU0NGgxNTJ2MTUyYzAgNC40IDMuNiA4IDggOGg0OGM0LjQgMCA4LTMuNiA4LThWNTQ0aDE1MmM0LjQgMCA4LTMuNiA4LTh2LTQ4YzAtNC40LTMuNi04LTgtOEg1NDRWMzI4YzAtNC40LTMuNi04LTgtOGgtNDhjLTQuNCAwLTggMy42LTggOHYxNTJIMzI4Yy00LjQgMC04IDMuNi04IDh2NDhjMCA0LjQgMy42IDggOCA4eiIgZmlsbD0iIzE2NzdmZiIgLz48L3N2Zz4=) */const m=e.forwardRef(v),y=({id:e,sourceX:t,sourceY:n,targetX:i,targetY:r,sourcePosition:d,targetPosition:p,source:x,target:k,getNode:v,edges:y})=>{const N=l.useContext(h);v(x),v(k);let f=y.filter((e=>e.source===x)),C=y.filter((e=>e.target===k));const $=async e=>{let t=await g({type:e,source:x,target:k});c(t)||N.initData()},E=async e=>{let t=await u({type:e,source:x,target:k});c(t)||N.initData()};return s.jsxs("div",{children:[f.length>1&&s.jsx(o,{trigger:"click",placement:"rightTop",title:s.jsxs("div",{children:[s.jsx("div",{children:s.jsx(a,{type:"link",onClick:()=>{$(j.approvalNode)},children:"审批人"})}),s.jsx("div",{children:s.jsx(a,{type:"link",onClick:()=>{$(j.ccNode)},children:"抄送人"})}),s.jsx("div",{children:s.jsx(a,{type:"link",onClick:()=>{$(j.handleNode)},children:"办理人"})})]}),children:s.jsx("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${t}px,${n+25}px)`,pointerEvents:"all",cursor:"pointer"},className:"nodrag nopan",children:s.jsx(m,{})})}),1===f.length&&C.length>1&&s.jsx(o,{trigger:"click",placement:"rightTop",title:s.jsxs("div",{children:[s.jsx("div",{children:s.jsx(a,{type:"link",onClick:()=>{$(j.approvalNode)},children:"审批人"})}),s.jsx("div",{children:s.jsx(a,{type:"link",onClick:()=>{$(j.ccNode)},children:"抄送人"})}),s.jsx("div",{children:s.jsx(a,{type:"link",onClick:()=>{$(j.handleNode)},children:"办理人"})}),s.jsx("div",{children:s.jsx(a,{type:"link",onClick:()=>{$(j.conditionNode)},children:"条件分支"})})]}),children:s.jsx("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${t}px,${n+25}px)`,pointerEvents:"all",cursor:"pointer"},className:"nodrag nopan",children:s.jsx(m,{})})}),1===f.length&&C.length>1&&s.jsx(o,{trigger:"click",placement:"rightTop",title:s.jsxs("div",{children:[s.jsx("div",{children:s.jsx(a,{type:"link",onClick:()=>{E(j.approvalNode)},children:"审批人"})}),s.jsx("div",{children:s.jsx(a,{type:"link",onClick:()=>{E(j.ccNode)},children:"抄送人"})}),s.jsx("div",{children:s.jsx(a,{type:"link",onClick:()=>{E(j.handleNode)},children:"办理人"})})]}),children:s.jsx("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${i}px,${r-25}px)`,pointerEvents:"all",cursor:"pointer"},className:"nodrag nopan",children:s.jsx(m,{})})}),1===f.length&&1===C.length&&s.jsx(o,{trigger:"click",placement:"rightTop",title:s.jsxs("div",{children:[s.jsx("div",{children:s.jsx(a,{type:"link",onClick:()=>{$(j.approvalNode)},children:"审批人"})}),s.jsx("div",{children:s.jsx(a,{type:"link",onClick:()=>{$(j.ccNode)},children:"抄送人"})}),s.jsx("div",{children:s.jsx(a,{type:"link",onClick:()=>{$(j.handleNode)},children:"办理人"})}),s.jsx("div",{children:s.jsx(a,{type:"link",onClick:()=>{$(j.conditionNode)},children:"条件分支"})})]}),children:s.jsx("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${t}px,${n+50}px)`,pointerEvents:"all",cursor:"pointer"},className:"nodrag nopan",children:s.jsx(m,{})})}),f.length>1&&1===C.length&&s.jsx("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${t}px,${n+50}px)`,pointerEvents:"all"},className:"nodrag nopan",children:s.jsx(a,{type:"default",style:{height:"24px",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>{$(j.conditionNode)},children:"添加条件分支"},"condition")})]})};function N({id:t,sourceX:n,sourceY:l,targetX:o,targetY:a,sourcePosition:c,targetPosition:h,source:j,target:g}){const{setEdges:u,addNodes:k,getNodes:v,getNode:m,getEdges:N}=d(),[f,C]=e.useState(i.close);let $=N();m(j),m(g);const E=function(){let e=`M ${n},${l}`;return e+=` L ${n},${l+50}`,e+=` L ${o},${l+50}`,e+=` L ${o},${a}`,e}();return s.jsxs(s.Fragment,{children:[s.jsx(p,{id:t,path:E}),s.jsx(x,{children:s.jsx(y,{id:t,sourceX:n,sourceY:l,targetX:o,targetY:a,sourcePosition:c,targetPosition:h,source:j,target:g,getNode:m,edges:$},"myTip")}),s.jsx("div",{children:s.jsx(r,{title:"设置审批人",open:f!==i.close,width:"50%",destroyOnClose:!0,maskClosable:!1,onClose:()=>C(i.close),footer:null})})]})}export{N as default};
